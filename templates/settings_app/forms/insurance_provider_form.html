<section class="main-content">
<form id="insurance-provider-form" class="coding_form" data-type="insurance-provider" data-id="{{ provider.id|default:'' }}" data-parent="{{ parent_id|default:'' }}">
    {% csrf_token %}
    
    <div class="coding_form-group">
        <label for="name">نام بیمه‌گر</label>
        <input type="text" id="name" name="name" class="coding_form-control" value="{{ provider.name|default:'' }}" required>
    </div>
    
    <div class="coding_form-group">
        <label for="insurance_type">نوع بیمه</label>
        {% if provider and provider.insurance_type %}
            <!-- فیلد فقط خواندنی برای ویرایش -->
            <input type="text" class="coding_form-control" value="{{ provider.insurance_type.name }}" readonly>
            <input type="hidden" id="insurance_type" name="insurance_type" value="{{ provider.insurance_type.id }}">
        {% else %}
            <!-- فیلد قابل انتخاب برای ایجاد جدید -->
            <select id="insurance_type" name="insurance_type" class="coding_form-control" required>
                {% for type in insurance_types %}
                <option value="{{ type.id }}" {% if parent_id == type.id|stringformat:"i" %}selected{% endif %}>{{ type.name }}</option>
                {% endfor %}
            </select>
        {% endif %}
    </div>
    
    <div class="coding_form-group">
        <label for="code">کد بیمه‌گر</label>
        <input type="text" id="code" name="code" class="coding_form-control" value="{{ provider.code|default:'' }}">
    </div>
    
    <div class="coding_form-group">
        <label for="logo">لوگو</label>
        <div class="coding_file-input-wrapper">
            <input type="file" id="logo" name="logo" class="coding_form-control-file">
            {% if provider.logo %}
            <div class="coding_current-file">
                <img src="{{ provider.logo.url }}" alt="{{ provider.name }}" class="coding_thumbnail">
                <span>{{ provider.logo.name }}</span>
            </div>
            {% endif %}
        </div>
    </div>
    
    <div class="coding_form-group">
        <label for="contact_info">اطلاعات تماس</label>
        <input type="text" id="contact_info" name="contact_info" class="coding_form-control" value="{{ provider.contact_info|default:'' }}">
    </div>
    
    <div class="coding_form-group">
        <label for="website">وب‌سایت</label>
        <input type="url" id="website" name="website" class="coding_form-control" value="{{ provider.website|default:'' }}">
    </div>
    
    <div class="coding_form-group">
        <div class="coding_checkbox">
            <input type="checkbox" id="is_active" name="is_active" {% if provider.is_active|default:True %}checked{% endif %}>
            <label for="is_active">فعال</label>
        </div>
    </div>
    
    <div class="coding_form-actions">
    <button type="submit" class="coding_btn coding_btn-primary">ذخیره</button>
    {% if insurance_type.id and insurance_type.name != 'آزاد' and insurance_type.name != 'درصدی' and insurance_type.name != 'تعرفه‌ای' %}
    <button type="button" class="coding_btn coding_btn-danger coding_delete-btn" data-id="{{ insurance_type.id }}" data-type="insurance-type">حذف</button>
    {% endif %}
    <button type="button" class="coding_btn coding_btn-secondary coding_cancel-btn">انصراف</button>
</div>
</form>
</section>