{% extends 'dashboard.html'%}
{% load static %}
{% block title %}Ú©Ø§Ø±Ø¨Ø±Ø§Ù†{% endblock %}
{% block content %}
<section class="main-content">

    <div class="content-section">
        <!-- Action Buttons -->
        <div class="action-buttons">
            
            <a href="{% url 'create_user' %}" class="action-button btn-primary">
                <i class="fas fa-plus"></i>
                Ø¬Ø¯ÛŒØ¯
            </a>
            
            
            <button class="action-button btn-secondary">
                <i class="fas fa-file-export"></i>
                Ø®Ø±ÙˆØ¬ÛŒ
            </button>
            <button class="action-button btn-secondary">
                <i class="fas fa-print"></i>
                Ú†Ø§Ù¾
            </button>
            <button class="action-button btn-secondary">
                <i class="fas fa-sync-alt"></i>
                Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
            </button>
        </div>
    
        <!-- Search Section -->
        <div class="search-section">
            <input type="text" class="search-input" placeholder="Ø¬Ø³ØªØ¬Ùˆ...">
            <select class="select-filter">
                <option value="">ÙˆØ¶Ø¹ÛŒØª</option>
                <option value="all">Ù‡Ù…Ù‡</option>
                <option value="active">ÙØ¹Ø§Ù„</option>
                <option value="inactive">ØºÛŒØ±ÙØ¹Ø§Ù„</option>
            </select>
            <select class="select-filter">
                <option value="">Ø³Ù…Øª</option>
                <option value="all">Ù‡Ù…Ù‡</option>
                <option value="doctor">Ù¾Ø²Ø´Ú©</option>
                <option value="assistant">Ø¯Ø³ØªÛŒØ§Ø±</option>
                <option value="reception">Ù¾Ø°ÛŒØ±Ø´</option>
            </select>
            <button class="show-button">Ù†Ù…Ø§ÛŒØ´</button>
        </div>
    
      <!-- Example User Card -->
<div class="users-grid">
    {% for profile in profiles %}
    <div class="user-card">
        <!-- Ù†Ø´Ø§Ù†Ú¯Ø± ÙˆØ¶Ø¹ÛŒØª -->
        <span class="status-badge {% if profile.is_activate %}status-active{% else %}status-inactive{% endif %}">
            {% if profile.is_activate %}ÙØ¹Ø§Ù„{% else %}ØºÛŒØ±ÙØ¹Ø§Ù„{% endif %}
        </span>

        <!-- Ø¯Ú©Ù…Ù‡ ÙˆÛŒØ±Ø§ÛŒØ´ -->
        <button class="edit-button" onclick="location.href='{% url 'edit_user' profile.id %}'">
            <i class="fas fa-edit"></i>
        </button>

        <div class="user-info">
            <!-- Ø¨Ø®Ø´ Ø¢ÙˆØ§ØªØ§Ø± -->
            <div class="avatar-container">
                {% if profile.avatar and profile.avatar.url != '/media/default.jpg' %}
                    <img src="{{ profile.avatar.url }}" alt="{{ profile.first_name }}" class="user-avatar">
                {% else %}
                    <div class="default-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                {% endif %}
            </div>

            <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± -->
            <div class="user-details">
                <!-- Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ -->
                <div class="detail-row">
                    <span class="detail-label">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ:</span>
                    <span class="detail-value">{{ profile.first_name }} {{ profile.last_name }}</span>
                </div>

                <!-- Ø¬Ù†Ø³ÛŒØª -->
                <div class="detail-row">
                    <span class="gender-badge {% if profile.sex %}gender-male{% else %}gender-female{% endif %}">
                        <i class="fas {% if profile.sex %}fa-mars{% else %}fa-venus{% endif %}"></i>
                        {% if profile.sex %}Ù…Ø±Ø¯{% else %}Ø²Ù†{% endif %}
                    </span>
                </div>

                <!-- Ø³Ù…Øª -->
                <div class="user-position">
                    <i class="fas fa-user-md"></i>
                    Ø³Ù…Øª: {{ profile.role.name|default:"Ù†Ø§Ù…Ø´Ø®Øµ" }}
                </div>

                <!-- Ø´Ù…Ø§Ø±Ù‡ Ù¾Ø±Ø³Ù†Ù„ÛŒ -->
                <div class="user-id">
                    <i class="fas fa-id-card"></i>
                    Ø´Ù…Ø§Ø±Ù‡ Ù¾Ø±Ø³Ù†Ù„ÛŒ: {{ profile.personal_number }}
                </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="no-users">
        <p>Ù‡ÛŒÚ† Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</p>
    </div>
    {% endfor %}
</div>

</section>
{% block JavaScript %}
<script>
    // ØªØºÛŒÛŒØ± Ø­Ø§Ù„Øª Ø´Ø¨ Ùˆ Ø±ÙˆØ²
    document.getElementById("mode-toggle").addEventListener("click", function () {
        document.body.classList.toggle("dark-mode");
        document.body.classList.toggle("light-mode");

        if (document.body.classList.contains("dark-mode")) {
            this.innerHTML = "ğŸŒ™";
            this.setAttribute("title", "Ø­Ø§Ù„Øª Ø±ÙˆØ² Ø±Ø§ ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯");
        } else {
            this.innerHTML = "ğŸŒ";
            this.setAttribute("title", "Ø­Ø§Ù„Øª Ø´Ø¨ Ø±Ø§ ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯");
        }
    });

    // ØªØ§Ø¨Ø¹ Ø®Ø±ÙˆØ¬ Ø¯Ø³ØªÛŒ
    function logoutUser() {
        fetch('/logout/', {
            method: 'POST',
            headers: {
                "X-CSRFToken": getCookie("csrftoken")
            }
        }).then(() => {
            window.location.href = "/login";
        });
    }

    // ØªÙ†Ø¸ÛŒÙ… Ø¯Ú©Ù…Ù‡ Ø®Ø±ÙˆØ¬
    document.getElementById("logout-btn").addEventListener("click", logoutUser);

    // Ø¯Ø±ÛŒØ§ÙØª ØªÙˆÚ©Ù† CSRF
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie) {
            const cookies = document.cookie.split(';');
            cookies.forEach(cookie => {
                const trimmedCookie = cookie.trim();
                if (trimmedCookie.startsWith(name + '=')) {
                    cookieValue = trimmedCookie.split('=')[1];
                }
            });
        }
        return cookieValue;
    }
</script>
{% endblock JavaScript %}
{% endblock content %}
