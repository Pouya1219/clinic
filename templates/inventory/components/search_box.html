<!-- templates/inventory/components/search_box.html -->
<div class="search-box-container mb-4">
    <div class="card">
        <div class="card-body">
            <div class="row">
                <!-- Main Search -->
                <div class="col-md-4">
                    <div class="input-group">
                        <input type="text" 
                               class="form-control" 
                               id="{{ search_id|default:'mainSearch' }}" 
                               placeholder="{{ search_placeholder|default:'جستجو...' }}"
                               autocomplete="off">
                        <button class="btn btn-outline-secondary" type="button" onclick="{{ search_function|default:'performSearch()' }}">
                            <i class="fas fa-search"></i>
                        </button>
                        <button class="btn btn-outline-secondary" type="button" onclick="{{ clear_function|default:'clearSearch()' }}" title="پاک کردن">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <!-- Search Suggestions -->
                    <div class="search-suggestions" id="{{ search_id|default:'mainSearch' }}Suggestions" style="display: none;">
                        <div class="list-group position-absolute w-100" style="z-index: 1000;">
                            <!-- Suggestions will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Advanced Search Toggle -->
                <div class="col-md-2">
                    <button class="btn btn-outline-primary w-100" type="button" data-bs-toggle="collapse" data-bs-target="#advancedSearch" aria-expanded="false">
                        <i class="fas fa-filter me-2"></i>
                        فیلتر پیشرفته
                    </button>
                </div>

                <!-- Quick Actions -->
                <div class="col-md-6 text-end">
                    {% if show_export %}
                    <button class="btn btn-outline-success" onclick="{{ export_function|default:'exportData()' }}">
                        <i class="fas fa-download me-2"></i>
                        خروجی Excel
                    </button>
                    {% endif %}
                    
                    {% if show_print %}
                    <button class="btn btn-outline-secondary" onclick="{{ print_function|default:'printData()' }}">
                        <i class="fas fa-print me-2"></i>
                        چاپ
                    </button>
                    {% endif %}
                    
                    {% if show_refresh %}
                    <button class="btn btn-outline-info" onclick="{{ refresh_function|default:'refreshData()' }}">
                        <i class="fas fa-sync-alt me-2"></i>
                        بروزرسانی
                    </button>
                    {% endif %}
                </div>
            </div>

            <!-- Advanced Search Filters -->
            <div class="collapse mt-3" id="advancedSearch">
                <div class="row">
                    {% block advanced_filters %}
                    <!-- Default filters - can be overridden -->
                    <div class="col-md-3">
                        <label class="form-label">دسته‌بندی:</label>
                        <select class="form-select" id="categoryFilter">
                            <option value="">همه دسته‌ها</option>
                            {% for category in categories %}
                            <option value="{{ category.id }}">{{ category.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="col-md-3">
                        <label class="form-label">از تاریخ:</label>
                        <input type="date" class="form-control" id="dateFromFilter">
                    </div>
                    
                    <div class="col-md-3">
                        <label class="form-label">تا تاریخ:</label>
                        <input type="date" class="form-control" id="dateToFilter">
                    </div>
                    
                    <div class="col-md-3">
                        <label class="form-label">وضعیت:</label>
                        <select class="form-select" id="statusFilter">
                            <option value="">همه وضعیت‌ها</option>
                            <option value="active">فعال</option>
                            <option value="inactive">غیرفعال</option>
                        </select>
                    </div>
                    {% endblock %}
                </div>
                
                <div class="row mt-3">
                    <div class="col-12 text-end">
                        <button class="btn btn-primary" onclick="{{ apply_filters_function|default:'applyFilters()' }}">
                            <i class="fas fa-check me-2"></i>
                            اعمال فیلترها
                        </button>
                        <button class="btn btn-secondary" onclick="{{ reset_filters_function|default:'resetFilters()' }}">
                            <i class="fas fa-undo me-2"></i>
                            پاک کردن فیلترها
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.search-suggestions {
    position: relative;
}

.search-suggestions .list-group {
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid #dee2e6;
    border-radius: 0.375rem;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
}

.search-suggestions .list-group-item {
    cursor: pointer;
    border-left: none;
    border-right: none;
}

.search-suggestions .list-group-item:hover {
    background-color: #f8f9fa;
}

.search-suggestions .list-group-item:first-child {
    border-top: none;
}

.search-suggestions .list-group-item:last-child {
    border-bottom: none;
}
</style>
