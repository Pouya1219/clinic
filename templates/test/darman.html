<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <title>پرونده بیمار</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- برای Excel -->
<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<!-- برای PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
            --danger-color: #f44336;
            --warning-color: #ff9800;
            --success-color: #4CAF50;
            --info-color: #00bcd4;
            --dark-color: #333;
            --light-color: #f4f4f4;
            --border-color: #ddd;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --tooltip-bg: #333;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'IRANSans', Tahoma, Arial;
        }

        body {
            background-color: #f8f9fa;
        }

        /* Main Navigation Bar */
        .main-nav {
            height: 70px;
            background: white;
            box-shadow: 0 2px 10px var(--shadow-color);
            display: flex;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            right: 0;
            left: 0;
            z-index: 1000;
        }

        .nav-tabs {
            display: flex;
            gap: 15px;
            height: 100%;
            align-items: center;
        }

        .nav-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            color: var(--dark-color);
            text-decoration: none;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-tab i {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .nav-tab span {
            font-size: 12px;
        }

        .nav-tab:hover {
            color: var(--primary-color);
        }

        .nav-tab.active {
            color: var(--primary-color);
        }

        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-color);
            border-radius: 3px 3px 0 0;
        }

        /* Tooltip */
        .nav-tab::before {
            content: attr(data-tooltip);
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 5px 10px;
            background: var(--tooltip-bg);
            color: white;
            font-size: 12px;
            border-radius: 4px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .nav-tab:hover::before {
            opacity: 1;
            visibility: visible;
            top: 90%;
        }

        /* Content Area */
        .content-area {
            margin-top: 90px;
            padding: 20px;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Patient Info Styles */
.patient-header {
    background: white;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 2px 10px var(--shadow-color);
    margin-bottom: 20px;
}

.header-tabs-darman {
    display: flex;
    gap: 15px;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 10px;
    margin-bottom: 15px;
}

.header-tab-darman {
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.header-tab:hover {
    background: var(--light-color);
}

.header-tab-darman.active {
    background: var(--primary-color);
    color: white;
}

.patient-profile {
    display: grid;
    grid-template-columns: 200px 1fr;
    gap: 30px;
}

.profile-image {
    width: 200px;
    height: 200px;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 2px 10px var(--shadow-color);
}

.profile-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.patient-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
}

.info-group {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    transition: all 0.3s ease;
}

.info-group:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 10px var(--shadow-color);
}

.info-label {
    color: var(--dark-color);
    font-size: 0.9em;
    margin-bottom: 5px;
    opacity: 0.8;
}

.info-value {
    color: var(--dark-color);
    font-weight: bold;
}

.status-badge {
    display: inline-block;
    padding: 5px 10px;
    border-radius: 15px;
    font-size: 0.8em;
    font-weight: bold;
}

.status-active {
    background: #e8f5e9;
    color: var(--success-color);
}

.status-inactive {
    background: #ffebee;
    color: var(--danger-color);
}

.medical-history {
    background: white;
    padding: 20px;
    border-radius: 10px;
    margin-top: 20px;
    box-shadow: 0 2px 10px var(--shadow-color);
}

.history-title {
    font-size: 1.1em;
    color: var(--dark-color);
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border-color);
}

.history-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.history-item {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    border-right: 3px solid var(--primary-color);
}
/* Attachments Tab Specific Styles */
.attachment-container {
    padding: 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.attachment-toolbar {
    display: flex;
    gap: 15px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
    margin-bottom: 20px;
}

.attachment-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 14px;
}

.attachment-btn-primary {
    background: var(--primary-color);
    color: white;
}

.attachment-btn-danger {
    background: var(--danger-color);
    color: white;
}

.attachment-btn-secondary {
    background: #6c757d;
    color: white;
}

.attachment-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 20px;
    padding: 20px;
}

.attachment-item {
    position: relative;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
}

.attachment-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.attachment-checkbox {
    position: absolute;
    top: 10px;
    right: 210px;
    z-index: 2;
}

.attachment-checkbox input {
    width: 18px;
    height: 18px;
    cursor: pointer;
}

.attachment-image {
    width: 100%;
    height: 200px;
    object-fit: cover;
    cursor: pointer;
}

.attachment-info {
    padding: 10px;
    background: white;
}

.attachment-name {
    font-size: 14px;
    color: #333;
    margin-bottom: 5px;
}

.attachment-date {
    font-size: 12px;
    color: #666;
}

/* Modal Styles */
.attachment-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.8);
    z-index: 1000;
    justify-content: center;
    align-items: center;
    animation: attachmentFadeIn 0.3s ease;
}

.attachment-modal.active {
    display: flex;
}

.attachment-modal-content {
    position: relative;
    max-width: 90%;
    max-height: 90vh;
}

.attachment-modal-image {
    max-width: 100%;
    max-height: 90vh;
    object-fit: contain;
    border-radius: 8px;
}

.attachment-modal-close {
    position: absolute;
    top: -40px;
    right: 0;
    background: white;
    border: none;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.attachment-modal-close:hover {
    background: #f44336;
    color: white;
}

@keyframes attachmentFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}
/* Treatment Tab Specific Styles */
.treatment-container {
    padding: 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.teeth-chart {
    display: grid;
    grid-template-columns: repeat(16, 1fr);
    gap: 5px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 10px;
    margin-bottom: 20px;
}

.tooth {
    aspect-ratio: 1;
    background: white;
    border: 2px solid #ddd;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
}

.tooth:hover {
    border-color: var(--primary-color);
    transform: translateY(-2px);
}

.tooth.selected {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.treatment-form {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}

.treatment-group {
    margin-bottom: 15px;
}

.treatment-label {
    display: block;
    margin-bottom: 8px;
    color: #555;
    font-size: 14px;
}

.treatment-input {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 14px;
    transition: all 0.3s ease;
}

.treatment-input:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
    outline: none;
}

.treatment-select {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 14px;
    appearance: none;
    background: white url("data:image/svg+xml,...") no-repeat right 12px center;
}

.treatment-checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}

.treatment-checkbox input {
    width: 16px;
    height: 16px;
}

.treatment-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 30px;
}

.treatment-table th,
.treatment-table td {
    padding: 12px;
    border: 1px solid #ddd;
    text-align: right;
    font-size: 14px;
}

.treatment-table th {
    background: #f8f9fa;
    font-weight: bold;
}

.treatment-table tr:hover {
    background: #f8f9fa;
}

.treatment-submit {

    margin:20px;
    background: var(--primary-color);
    color: white;
    padding: 12px 24px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 20px;
}

.treatment-submit:hover {
    color:green;
    background: var(--primary-hover);
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
/*tarhe darman*/
.treatment-plan-container {
    padding: 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.treatment-plan-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #eee;
}

.treatment-plan-title {
    font-size: 1.2em;
    color: var(--primary-color);
}

.treatment-plan-actions {
    display: flex;
    gap: 10px;
}

.plan-btn {
    padding: 8px 16px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.plan-btn-primary {
    background: var(--primary-color);
    color: white;
}

.plan-btn-primary:hover {
    background: var(--primary-hover);
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.treatment-plan-form {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.plan-group {
    margin-bottom: 15px;
}

.plan-label {
    display: block;
    margin-bottom: 8px;
    color: #555;
    font-size: 14px;
}

.plan-input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    transition: all 0.3s ease;
}

.plan-input:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
    outline: none;
}

.plan-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

.plan-table th,
.plan-table td {
    padding: 12px;
    border: 1px solid #eee;
    text-align: right;
}

.plan-table th {
    background: #f8f9fa;
    font-weight: bold;
    color: #333;
}

.plan-table tbody tr {
    transition: all 0.3s ease;
}

.plan-table tbody tr:hover {
    background: #f8f9fa;
}

.plan-status {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: bold;
}

.status-pending {
    background: #fff3e0;
    color: #f57c00;
}

.status-approved {
    background: #e8f5e9;
    color: #4caf50;
}

.status-rejected {
    background: #ffebee;
    color: #f44336;
}

/* Animation for tab switching */
.tab-content {
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.3s ease;
    display: none;
}

.tab-content.active {
    opacity: 1;
    transform: translateY(0);
    display: block;
}
/* Payment Tab Specific Styles */
.payment-container {
    padding: 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.payment-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
}

.payment-table th,
.payment-table td {
    padding: 12px 15px;
    border: 1px solid #eee;
    text-align: right;
}

.payment-table th {
    background: #f8f9fa;
    font-weight: bold;
    color: #333;
}

.payment-table tbody tr {
    transition: all 0.3s ease;
}

.payment-table tbody tr:hover {
    background: #f8f9fa;
}

.payment-amount {
    font-family: 'IRANSansNumbers', 'IRANSans';
    color: #2196F3;
    font-weight: bold;
}

.payment-btn {
    padding: 10px 20px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.payment-btn:hover {
    background: var(--primary-hover);
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

/* Payment Modal Styles */
.payment-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}

.payment-modal.active {
    display: flex;
    animation: modalFadeIn 0.3s ease;
}

.payment-modal-content {
    margin-top:720px;
    top:0;
    background: white;
    padding: 25px;
    border-radius: 10px;
    width: 100%;
    max-width: 500px;
    position: sticky;
    transform: translateY(20px);
    z-index: 100;
    opacity: 0;
    animation: modalSlideIn 0.3s ease forwards;
}

.payment-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
}

.payment-modal-title {
    font-size: 1.2em;
    color: #333;
}

.payment-modal-close {
    background: none;
    border: none;
    font-size: 1.5em;
    cursor: pointer;
    color: #666;
    transition: all 0.3s ease;
}

.payment-modal-close:hover {
    color: #f44336;
}

.payment-form {
    display: grid;
    gap: 15px;
}

.payment-form-group {
    display: grid;
    gap: 8px;
}

.payment-label {
    font-size: 14px;
    color: #555;
}

.payment-input,
.payment-select {
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 14px;
    transition: all 0.3s ease;
}

.payment-input:focus,
.payment-select:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
    outline: none;
}

.payment-check-fields {
    display: none;
}

.payment-check-fields.active {
    display: grid;
    gap: 15px;
    animation: fadeIn 0.3s ease;
}

.payment-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
}

.payment-history {
    margin-top: 30px;
}

.payment-history-title {
    font-size: 1.1em;
    color: #333;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
}

@keyframes modalFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes modalSlideIn {
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}
/*tab emtiazat*/
/* Points Tab Specific Styles */
.points-container {
    padding: 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.points-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
}

.points-summary {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.points-card {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    padding: 20px;
    border-radius: 10px;
    color: white;
    position: relative;
    overflow: hidden;
}

.points-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255,255,255,0.1), transparent);
    z-index: 1;
}

.points-card-title {
    font-size: 0.9em;
    margin-bottom: 10px;
    opacity: 0.9;
    position: relative;
    z-index: 2;
}

.points-card-value {
    font-size: 2em;
    font-weight: bold;
    position: relative;
    z-index: 2;
}

.points-history {
    background: white;
    border-radius: 10px;
    overflow: hidden;
}

.points-table {
    width: 100%;
    border-collapse: collapse;
}

.points-table th,
.points-table td {
    padding: 15px;
    text-align: right;
    border-bottom: 1px solid #eee;
}

.points-table th {
    background: #f8f9fa;
    font-weight: bold;
    color: #333;
}

.points-table tbody tr {
    transition: all 0.3s ease;
}

.points-table tbody tr:hover {
    background: #f8f9fa;
}

.points-badge {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 5px 10px;
    border-radius: 15px;
    font-size: 0.9em;
}

.points-earned {
    background: #e8f5e9;
    color: var(--success-color);
}

.points-spent {
    background: #ffebee;
    color: var(--danger-color);
}

.points-filters {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
}

.points-filter {
    padding: 8px 15px;
    border: 1px solid #ddd;
    border-radius: 5px;
    background: white;
    cursor: pointer;
    transition: all 0.3s ease;
}

.points-filter:hover,
.points-filter.active {
    border-color: var(--primary-color);
    color: var(--primary-color);
}

@keyframes pointsFadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}
/* Custom Styles with Unique Names */
.dental-chart-wrapper {
    justify-content: center;
    display:flex;
    padding: 25px;
    background: linear-gradient(to bottom, #ffffff, #f8f9fa);
    border-radius: 15px;
    box-shadow: 0 3px 15px rgba(0,0,0,0.05);
    margin-bottom: 30px;
}

.dental-upper-row,
.dental-lower-row {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin: 20px 0;
}

.dental-single-tooth {
    width: 45px;
    height: 45px;
    position: relative;
    cursor: pointer;
}

.dental-tooth-icon {
    width: 100%;
    height: 100%;
    background: white;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.dental-tooth-icon i {
    font-size: 20px;
    color: #666;
    transition: all 0.3s ease;
}

.dental-tooth-number {
    position: absolute;
    bottom: -20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 11px;
    color: #666;
}

.dental-single-tooth:hover .dental-tooth-icon {
    border-color: #4CAF50;
    transform: translateY(-2px);
    box-shadow: 0 3px 10px rgba(76, 175, 80, 0.2);
}

.dental-single-tooth.selected .dental-tooth-icon {
    background: #4CAF50;
    border-color: #4CAF50;
}

.dental-single-tooth.selected i {
    color: white;
}

/* Treatment Type Buttons */
.dental-treatment-types {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin: 25px 0;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 12px;
}

.dental-type-button {
    padding: 12px 24px;
    background: white;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    color: #333;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.dental-type-button i {
    font-size: 16px;
}

.dental-type-button:hover {
    border-color: #4CAF50;
    color: #4CAF50;
    transform: translateY(-2px);
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}

.dental-type-button.active {
    background: #4CAF50;
    border-color: #4CAF50;
    color: white;
}

/* Treatment Description Styles */
.dental-description-wrapper {
    position: relative;
    margin: 20px 0;
}

.dental-search-box {
    position: relative;
}

.search-icon {
    position: absolute;
    left: 15px;
    top: 50%;
    transform: translateY(-50%);
    color: #666;
}

.dental-description-select {
    width: 100%;
    padding: 12px 35px 12px 15px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
    transition: all 0.3s ease;
}

.dental-description-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    margin-top: 5px;
    max-height: 300px;
    overflow-y: auto;
    display: none;
    z-index: 1000;
}

.dental-description-dropdown.active {
    display: block;
    animation: fadeIn 0.3s ease;
}

.dental-description-group {
    display: none;
}

.dental-description-item {
    padding: 12px 15px;
    cursor: pointer;
    transition: all 0.2s ease;
    border-bottom: 1px solid #f0f0f0;
}

.dental-description-item:hover {
    background: #f8f9fa;
    color: #4CAF50;
}

.dental-treatment-details {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.dental-form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.dental-form-group label {
    font-size: 14px;
    color: #666;
}

.dental-fee-input {
    padding: 10px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
    background: #f8f9fa;
    cursor: not-allowed;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}
/* Numbering System Styles */
.dental-numbering-system {
    margin-bottom: 20px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
    display: flex;
    gap: 20px;
}

.dental-radio-label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}

/* Quick Select Buttons */
.dental-quick-select {
    margin-bottom: 20px;
    display: flex;
    gap: 10px;
}

.dental-select-btn {
    padding: 8px 15px;
    border: 2px solid #4CAF50;
    border-radius: 5px;
    background: white;
    color: #4CAF50;
    cursor: pointer;
    transition: all 0.3s ease;
}

.dental-select-btn:hover {
    background: #4CAF50;
    color: white;
}

/* Modal Styles */
.dental-icon-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}

.dental-icon-modal.active {
    display: flex;
}

.dental-modal-content {
    background: white;
    border-radius: 10px;
    width: 90%;
    max-width: 600px;
    max-height: 90vh;
    overflow-y: auto;
}

.dental-modal-header {
    padding: 15px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.dental-modal-close {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #666;
}

.dental-modal-body {
    padding: 20px;
}

.dental-icon-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
}

.dental-icon-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    padding: 10px;
    border: 2px solid #eee;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.dental-icon-option:hover {
    border-color: #4CAF50;
    transform: translateY(-2px);
}

.dental-icon-option i {
    font-size: 24px;
    color: #666;
}

.dental-icon-option span {
    font-size: 12px;
    text-align: center;
}

.dental-tooth-notes {
    margin-top: 20px;
}

.dental-tooth-note {
    width: 100%;
    height: 100px;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    resize: vertical;
}
/* استایل دکمه‌های مودال */
.dental-modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid #eee;
}

.dental-modal-save,
.dental-modal-cancel {
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    font-family: 'IRANSans', sans-serif;
    font-size: 14px;
}

.dental-modal-save {
    background: #4CAF50;
    color: white;
}

.dental-modal-save:hover {
    background: #45a049;
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
}

.dental-modal-cancel {
    background: #f8f9fa;
    color: #666;
    border: 1px solid #ddd;
}

.dental-modal-cancel:hover {
    background: #f1f3f4;
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* استایل آیکون‌های انتخاب شده */
.dental-icon-option {
    position: relative;
    border: 2px solid #eee;
    padding: 15px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.dental-icon-option.selected {
    border-color: #4CAF50;
    background: #e8f5e9;
}

.dental-icon-option.selected::after {
    content: '✓';
    position: absolute;
    top: 5px;
    right: 5px;
    color: #4CAF50;
    font-size: 12px;
}

/* استایل برای دندان‌های با آیکون متفاوت */
.dental-tooth-icon[data-icon="implant"] {
    background: #e3f2fd;
    border-color: #2196F3;
}

.dental-tooth-icon[data-icon="missing"] {
    background: #ffebee;
    border-color: #f44336;
}

.dental-tooth-icon[data-icon="crown"] {
    background: #fff3e0;
    border-color: #ff9800;
}
/* Treatment Plan Styles */
.treatment-plan-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.print-button {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.print-button:hover {
    background: var(--primary-hover);
    transform: translateY(-2px);
}

.treatment-plan-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

.treatment-plan-table th,
.treatment-plan-table td {
    padding: 12px;
    border: 1px solid var(--border-color);
    text-align: right;
}

.treatment-plan-table th {
    background: var(--light-color);
    font-weight: bold;
}

/* Print Styles */
@media print {
    body * {
        visibility: hidden;
    }
    
    #print-template,
    #print-template * {
        visibility: visible;
    }

    #print-template {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
    }

    .print-header {
        margin-bottom: 30px;
        text-align: center;
    }

    .print-table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
    }

    .print-footer {
        margin-top: 50px;
        display: flex;
        justify-content: space-between;
    }
}
/* Print Styles */
@media print {
    @page {
        size: A4;
        margin: 1cm;
    }

    .print-page {
        font-family: 'IRANSans', Tahoma, Arial;
        color: #333;
        max-width: 210mm;
        margin: 0 auto;
        padding: 20px;
    }

    .print-header {
        display: flex;
        align-items: center;
        gap: 20px;
        padding-bottom: 20px;
        border-bottom: 2px solid #4CAF50;
    }

    .clinic-logo {
        width: 100px;
        height: 100px;
    }

    .clinic-logo i {
        font-size: 80px;
        color: #4CAF50;
    }

    .clinic-info {
        flex: 1;
    }

    .clinic-info h1 {
        color: #4CAF50;
        font-size: 24px;
        margin-bottom: 5px;
    }

    .clinic-details {
        display: flex;
        gap: 20px;
        font-size: 12px;
        color: #666;
    }

    .patient-info {
        margin: 20px 0;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
    }

    .patient-header {
        display: flex;
        gap: 20px;
        align-items: center;
    }

    .patient-avatar {
        width: 80px;
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #fff;
        border-radius: 50%;
        border: 2px solid #4CAF50;
    }

    .patient-avatar i {
        font-size: 50px;
        color: #4CAF50;
    }

    .patient-details table {
        width: 100%;
        border-collapse: collapse;
    }

    .patient-details th,
    .patient-details td {
        padding: 5px 10px;
        text-align: right;
        font-size: 14px;
    }

    .patient-details th {
        color: #666;
        font-weight: normal;
        width: 120px;
    }

    .treatment-plan-title {
        text-align: center;
        margin: 30px 0;
    }

    .treatment-plan-title h2 {
        color: #4CAF50;
        margin-bottom: 5px;
    }

    .plan-date {
        font-size: 14px;
        color: #666;
    }

    .treatment-table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
    }

    .treatment-table th,
    .treatment-table td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: center;
    }

    .treatment-table th {
        background: #f8f9fa;
        color: #333;
    }

    .treatment-table tbody tr:nth-child(even) {
        background: #f8f9fa;
    }

    .treatment-table tfoot {
        font-weight: bold;
    }

    .treatment-notes {
        margin: 30px 0;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
    }

    .treatment-notes h3 {
        color: #4CAF50;
        margin-bottom: 10px;
    }

    .treatment-notes p {
        font-size: 14px;
        margin: 5px 0;
    }

    .print-footer {
        margin-top: 50px;
        border-top: 2px solid #4CAF50;
        padding-top: 20px;
    }

    .signatures {
        display: flex;
        justify-content: space-between;
        margin-bottom: 30px;
    }

    .signature-box {
        text-align: center;
    }

    .signature-line {
        width: 200px;
        height: 60px;
        border: 1px solid #ddd;
        margin-top: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #666;
        font-style: italic;
    }

    .clinic-footer {
        text-align: center;
        font-size: 12px;
        color: #666;
    }
}
@media print {
    /* CSS قبلی برای پرینت */
    body * {
        visibility: hidden;
    }
    
    #print-template,
    #print-template * {
        visibility: visible;
    }

    #print-template {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
    }
}
/* Print Buttons Styles */
.print-buttons {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.print-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.print-btn.thermal {
    background: #ff9800;
    color: white;
}

.print-btn.normal {
    background: #4CAF50;
    color: white;
}

.print-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

/* Print Options Modal Styles */
.print-options-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}

.print-options-content {
    background: white;
    border-radius: 10px;
    padding: 20px;
    width: 90%;
    max-width: 500px;
}

.print-options-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid #ddd;
}

.print-options-group {
    display: grid;
    gap: 15px;
    margin-bottom: 20px;
}

.checkbox-container {
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
}

.print-options-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}

.print-option-btn {
    padding: 8px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.print-option-btn.print {
    background: #4CAF50;
    color: white;
}

.print-option-btn.cancel {
    background: #f44336;
    color: white;
}
.payment-print-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}

.payment-print-content {
    background: white;
    border-radius: 10px;
    padding: 20px;
    width: 90%;
    max-width: 500px;
}

.payment-print-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid #ddd;
}

.payment-modal-close {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #666;
}

.payment-modal-close:hover {
    color: #f44336;
}

.payment-print-group {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin-bottom: 20px;
}

.payment-checkbox-container {
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
}

.payment-print-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
}

.payment-print-btn {
    padding: 8px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.payment-print-btn.cancel {
    background: #f44336;
    color: white;
}

.payment-print-btn.print {
    background: #4CAF50;
    color: white;
}

.payment-print-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.payment-print-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}

.payment-print-content {
    background: white;
    padding: 20px;
    border-radius: 8px;
    max-width: 500px;
    width: 90%;
}

.payment-print-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.payment-modal-close {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #666;
}

.payment-modal-close:hover {
    color: #f44336;
}

.payment-print-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
}

.payment-print-btn-cancel,
.payment-print-btn-print {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.payment-print-btn-cancel {
    background: #f44336;
    color: white;
}

.payment-print-btn-print {
    background: #4CAF50;
    color: white;
}
/* Installment Fields Styles */
#installmentFields {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    margin-top: 15px;
    border: 1px solid #e9ecef;
}

.fade-in {
    animation: fadeIn 0.3s ease-in-out;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.payment-form-group {
    margin-bottom: 15px;
}

.payment-label {
    display: block;
    margin-bottom: 8px;
    color: #495057;
    font-size: 14px;
}

.payment-input {
    text-align:center;
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #ced4da;
    border-radius: 4px;
    transition: all 0.3s ease;
}

.payment-input:focus {
    border-color: #4CAF50;
    box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
    outline: none;
}

.date-input-container {
    position: relative;
}

.calendar-icon {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: #6c757d;
    cursor: pointer;
}

/* برای نمایش مبالغ با فرمت مناسب */
.payment-input[type="number"] {
    text-align: left;
    direction: ltr;
}

/* استایل برای select */
.payment-select {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #ced4da;
    border-radius: 4px;
    background-color: white;
    cursor: pointer;
    transition: all 0.3s ease;
}

.payment-select:focus {
    border-color: #4CAF50;
    box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
    outline: none;
}
/* Table Styles */
.treatment-table-container {
    overflow-x: auto;
    margin-top: 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.treatment-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
}

.treatment-table th,
.treatment-table td {
    padding: 12px 15px;
    border-bottom: 1px solid #eee;
    text-align: right;
    white-space: nowrap;
}

.treatment-table th {
    background: #f8f9fa;
    font-weight: bold;
    color: #333;
    position: sticky;
    top: 0;
    z-index: 10;
}

.treatment-table tbody tr:hover {
    background: #f8f9fa;
}

/* Action Buttons */
.action-buttons {
    display: flex;
    gap: 5px;
}

.action-btn {
    width: 32px;
    height: 32px;
    border: none;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.action-btn.edit {
    background: #2196F3;
    color: white;
}

.action-btn.delete {
    background: #f44336;
    color: white;
}

.action-btn.print {
    background: #4CAF50;
    color: white;
}

.action-btn.invoice {
    background: #ff9800;
    color: white;
}

.action-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

/* Settings Button */
.table-settings {
    margin-bottom: 15px;
}

.settings-btn {
    margin:20px;
    padding: 8px 15px;
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 5px;
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.settings-btn:hover {
    border-color: #4CAF50;
    color: #4CAF50;
}

/* Settings Modal */
.settings-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}

.settings-modal-content {
    background: white;
    border-radius: 10px;
    width: 90%;
    max-width: 500px;
    max-height: 90vh;
    overflow-y: auto;
}

.settings-modal-header {
    padding: 15px 20px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.settings-modal-body {
    padding: 20px;
}

.columns-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 10px;
}

.column-checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px;
    border: 1px solid #eee;
    border-radius: 5px;
    cursor: pointer;
}

.settings-modal-footer {
    padding: 15px 20px;
    border-top: 1px solid #eee;
    text-align: left;
}

.save-settings {
    padding: 8px 20px;
    background: #4CAF50;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.save-settings:hover {
    background: #45a049;
}

/* و سایر وضعیت‌ها */
/* Sub Navigation Styles */
.sub-nav {
    background: #f8f9fa;
    padding: 10px;
    border-radius: 8px;
    margin-bottom: 20px;
}

.sub-nav-tabs {
    display: flex;
    gap: 10px;
}

.sub-nav-tab {
    padding: 8px 15px;
    border: none;
    border-radius: 5px;
    background: white;
    cursor: pointer;
    transition: all 0.3s ease;
    color: #333; /* یا هر رنگ دیگری */
}

.sub-nav-tab:hover {
    background-color: #f0f0f0; /* یا هر رنگ دیگری */
}

.sub-nav-tab.active {
    background: var(--primary-color);
    color: white;
}

.sub-nav-tab.print-button {
    background: #4CAF50; /* یا هر رنگ دیگری */
    color: white;
    border: none;
}

.sub-nav-tab.print-button:hover {
    background: #45a049; /* یا هر رنگ دیگری */
}

.sub-nav-tab i {
    margin-left: 5px; /* فاصله بین آیکون و متن */
}

/* Sub Tab Content Styles */
.sub-tab-content {
    display: none;
    animation: fadeIn 0.3s ease;
}

.sub-tab-content.active {
    display: block;
}
/* استایل‌های فرم ویرایش */
.edit-profile-container {
    padding: 20px;
}

.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 20px;
}



.form-group label {
    margin-bottom: 8px;
    font-weight: bold;
}

.edit-input,
.insurance-input {
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
}

.form-actions {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
}

.save-btn,
.cancel-btn {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.save-btn {
    background-color: #4CAF50;
    color: white;
}

.cancel-btn {
    background-color: #f44336;
    color: white;
}

/* استایل‌های جدول بیمه */
.insurance-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

.insurance-table th,
.insurance-table td {
    padding: 12px;
    text-align: right;
    border: 1px solid #ddd;
}

.insurance-table th {
    background-color: #f5f5f5;
}

/* استایل‌های دکمه‌های عملیات */
.actions-cell {
    display: flex;
    gap: 8px;
}

.edit-btn,
.delete-btn {
    padding: 4px 8px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.edit-btn {
    background-color: #2196F3;
    color: white;
}

.delete-btn {
    background-color: #f44336;
    color: white;
}

/* استایل‌های چک‌باکس */
.checkbox-group {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: 8px;
}

/* استایل‌های اطلاعات تکمیلی */
.treatment-input {
    width: 100%;
    resize: vertical;
}

.treatment-table {
    width: 100%;
    margin-top: 20px;
}
.edit-profile-container {
    padding: 20px;
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.form-group {
    display: block;
    flex-direction: column;
}

.form-group.full-width {
    grid-column: 1 / -1;
}

.form-group label {
    margin-bottom: 8px;
    font-weight: 600;
    color: #333;
}

.form-group label::after {
    content: " *";
    color: #f44336;
    display: none;
}

.form-group label[required]::after {
    display: inline;
}

.edit-input {
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    transition: border-color 0.3s ease;
}

.edit-input:focus {
    border-color: #2196F3;
    outline: none;
    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);
}

.date-input-container {
    position: relative;
}

.date-input-container i {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: #666;
}

.date-input {
    padding-left: 35px;
}

.medical-info-section {
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #eee;
}

.medical-info-section h3 {
    margin-bottom: 20px;
    color: #333;
}

.form-actions {
    display: flex;
    gap: 15px;
    justify-content: flex-end;
    margin-top: 30px;
}

.save-btn,
.cancel-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
    transition: background-color 0.3s ease;
}

.save-btn {
    background-color: #4CAF50;
    color: white;
}

.save-btn:hover {
    background-color: #45a049;
}

.cancel-btn {
    background-color: #f44336;
    color: white;
}

.cancel-btn:hover {
    background-color: #da190b;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .form-grid {
        grid-template-columns: 1fr;
    }
    
    .form-actions {
        flex-direction: column;
    }
    
    .save-btn,
    .cancel-btn {
        width: 100%;
        justify-content: center;
    }
}
.insurance-info-container {
    padding: 20px;
}

.insurance-form {
    background-color: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-bottom: 30px;
}

.insurance-status-group {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    margin: 20px 0;
    padding: 15px;
    background-color: #f8f9fa;
    border-radius: 4px;
}

.status-checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}

.table-container {
    overflow-x: auto;
}

.insurance-table {
    width: 100%;
    border-collapse: collapse;
    background-color: #fff;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.insurance-table th,
.insurance-table td {
    padding: 12px;
    text-align: right;
    border-bottom: 1px solid #eee;
}

.insurance-table th {
    background-color: #f8f9fa;
    font-weight: 600;
    color: #333;
}

.status-cell {
    min-width: 200px;
}

.status-toggles {
    display: flex;
    gap: 10px;
}

.toggle-switch {
    position: relative;
    display: inline-block;
    width: 40px;
    height: 20px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 20px;
}

.toggle-slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 2px;
    bottom: 2px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

.toggle-switch input:checked + .toggle-slider {
    background-color: #4CAF50;
}

.toggle-switch input:checked + .toggle-slider:before {
    transform: translateX(20px);
}

.actions-cell {
    white-space: nowrap;
}

.edit-btn,
.delete-btn {
    padding: 6px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin: 0 2px;
}

.edit-btn {
    background-color: #2196F3;
    color: white;
}

.delete-btn {
    background-color: #f44336;
    color: white;
}

@media (max-width: 768px) {
    .insurance-status-group {
        flex-direction: column;
        gap: 10px;
    }
    
    .status-cell {
        min-width: 150px;
    }
}
.insurance-input {
    margin: 12px;
    padding: 8px 12px;
    border: 1px solid #b64c4c;
    border-radius: 4px;
    font-family: inherit;
}

.insurance-input:disabled {
    background-color: #f5f5f5;
    cursor: not-allowed;
}

.disabled-select {
    opacity: 0.7;
}

.has-value {
    opacity: 1;
}

/* استایل برای حالت hover روی select ها */
.insurance-input:not(:disabled):hover {
    border-color: #2196F3;
}

/* استایل برای حالت focus */
.insurance-input:not(:disabled):focus {
    border-color: #2196F3;
    outline: none;
    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);
}
.form-group-insurance{
    display:content;
    padding:15px;
    background-color:rgb(192, 196, 200);
}
.insurance-info-container {
    padding: 25px;
    background-color: #f8f9fa;
    border-radius: 12px;
}

.form-group-insurance {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    background-color: #ffffff;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
}

.form-group {
    position: relative;
    margin-bottom: 5px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-size: 14px;
    font-weight: 500;
    color: #444;
}

.form-group label::after {
    content: " *";
    color: #dc3545;
}

.insurance-input {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #e1e1e1;
    border-radius: 8px;
    font-size: 14px;
    transition: all 0.3s ease;
    background-color: #fff;
}

.insurance-input:focus {
    border-color: #4a90e2;
    box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
    outline: none;
}

.insurance-input:disabled {
    background-color: #f5f5f5;
    cursor: not-allowed;
}

.date-input-container {
    position: relative;
}

.date-input-container i {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #666;
    pointer-events: none;
}

.date-input {
    padding-left: 35px;
}

.insurance-status-group {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    background-color: #ffffff;
    padding: 20px;
    margin: 20px 0;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
}

.status-checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    padding: 8px 15px;
    border-radius: 6px;
    background-color: #f8f9fa;
    transition: all 0.3s ease;
}

.status-checkbox:hover {
    background-color: #e9ecef;
}

.status-checkbox input[type="checkbox"] {
    width: 18px;
    height: 18px;
    border-radius: 4px;
    border: 2px solid #4a90e2;
    cursor: pointer;
}

.form-actions {
    display: flex;
    justify-content: flex-end;
    margin-top: 20px;
}

.save-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 25px;
    background-color: #4a90e2;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
}

.save-btn:hover {
    background-color: #357abd;
    transform: translateY(-1px);
}

.save-btn i {
    font-size: 16px;
}

/* استایل برای select ها */
select.insurance-input {
    appearance: none;
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: left 12px center;
    background-size: 16px;
    padding-left: 35px;
}

/* استایل برای input های عددی */
input[type="number"].insurance-input {
    -moz-appearance: textfield;
}

input[type="number"].insurance-input::-webkit-outer-spin-button,
input[type="number"].insurance-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

/* استایل برای حالت responsive */
@media (max-width: 768px) {
    .insurance-info-container {
        padding: 15px;
    }

    .form-group-insurance {
        grid-template-columns: 1fr;
        gap: 15px;
        padding: 15px;
    }

    .insurance-status-group {
        flex-direction: column;
        gap: 10px;
    }

    .status-checkbox {
        width: 100%;
    }

    .save-btn {
        width: 100%;
        justify-content: center;
    }
}

/* استایل برای placeholder */
.insurance-input::placeholder {
    color: #999;
    font-size: 13px;
}

/* استایل برای حالت error */
.insurance-input.error {
    border-color: #dc3545;
}

.error-message {
    color: #dc3545;
    font-size: 12px;
    margin-top: 5px;
}
.med-add-info-container {
    padding: 25px;
    background-color: #f8f9fa;
    border-radius: 12px;
}

.med-add-info-section,
.med-add-info-history {
    background-color: #ffffff;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    margin-bottom: 25px;
}

.med-add-info-header {
    padding: 20px 25px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.med-add-info-header h3 {
    color: #333;
    font-size: 16px;
    font-weight: 600;
    margin: 0;
}

.med-add-info-form {
    padding: 25px;
}

.med-add-info-form-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 20px;
}

.med-add-info-form-group {
    margin-bottom: 20px;
}

.med-add-info-form-group label {
    display: block;
    margin-bottom: 8px;
    font-size: 14px;
    font-weight: 500;
    color: #444;
}

.med-add-info-input {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #e1e1e1;
    border-radius: 8px;
    font-size: 14px;
    transition: all 0.3s ease;
}

.med-add-info-input:focus {
    border-color: #4a90e2;
    box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
    outline: none;
}

.med-add-info-textarea {
    resize: vertical;
    min-height: 100px;
}

.med-add-info-date-container {
    position: relative;
}

.med-add-info-date-container i {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #666;
    pointer-events: none;
}

.med-add-info-submit {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 25px;
    background-color: #4a90e2;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
}

.med-add-info-submit:hover {
    background-color: #357abd;
    transform: translateY(-1px);
}

.med-add-info-header-actions {
    display: flex;
    gap: 15px;
}

.med-add-info-search {
    position: relative;
}

.med-add-info-search input {
    padding: 8px 35px 8px 15px;
    border: 1px solid #e1e1e1;
    border-radius: 6px;
    font-size: 13px;
    width: 250px;
}

.med-add-info-search i {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #666;
}

.med-add-info-table-wrapper {
    overflow-x: auto;
    padding: 0 25px 25px;
}

.med-add-info-table {
    width: 100%;
    border-collapse: collapse;
}

.med-add-info-table th,
.med-add-info-table td {
    padding: 15px;
    text-align: right;
    border-bottom: 1px solid #eee;
}

.med-add-info-table th {
    font-weight: 600;
    color: #444;
    background-color: #f8f9fa;
}

.med-add-info-details {
    max-width: 400px;
}

.med-add-info-text {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.med-add-info-actions-cell {
    white-space: nowrap;
    width: 100px;
}

.med-add-info-btn {
    padding: 6px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin: 0 2px;
    background: none;
    color: #666;
    transition: all 0.3s ease;
}

.med-add-info-edit:hover {
    color: #4a90e2;
    background-color: #f0f7ff;
}

.med-add-info-delete:hover {
    color: #dc3545;
    background-color: #fff5f5;
}

@media (max-width: 768px) {
    .med-add-info-container {
        padding: 15px;
    }

    .med-add-info-form-row {
        grid-template-columns: 1fr;
    }

    .med-add-info-search input {
        width: 100%;
    }

    .med-add-info-details {
        max-width: 200px;
    }
}
.med-print-container {
    padding: 20px;
    background-color: #f8f9fa;
    border-radius: 12px;
}

.med-print-toolbar {
    justify-content: space-between;
    align-items: center;
    background-color: #fff;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    margin-bottom: 20px;
}

.med-print-pages {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
}

.med-print-page-count {
    font-weight: bold;
    color: #4a90e2;
}

.med-print-actions {
    display: flex;
    gap: 15px;
}

.med-print-btn-group {
    display: flex;
    gap: 10px;
}

.med-print-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    border: none;
    border-radius: 6px;
    background-color: #4a90e2;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 14px;
}

.med-print-btn:hover {
    background-color: #357abd;
}

.med-print-dropdown {
    position: relative;
}

.med-print-dropdown-toggle {
    background-color: #28a745;
}

.med-print-dropdown-menu {
    position: absolute;
    top: 100%;
    right: 0;
    margin-top: 5px;
    background-color: white;
    border-radius: 6px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    display: none;
    min-width: 200px;
}

.med-print-dropdown-menu button {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
    padding: 12px 15px;
    border: none;
    background: none;
    cursor: pointer;
    transition: background-color 0.3s;
    color: #333;
}

.med-print-dropdown-menu button:hover {
    background-color: #f8f9fa;
}

.med-print-preview {
    background-color: #fff;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.med-print-page {
    max-width: 210mm;
    margin: 0 auto;
    padding: 20mm;
    background-color: white;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

.med-print-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 2px solid #eee;
}

.med-print-section {
    margin-bottom: 30px;
}

.med-print-section h3 {
    color: #333;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
}

.med-print-footer {
    margin-top: 30px;
    padding-top: 15px;
    border-top: 1px solid #eee;
    text-align: center;
}

@media print {
    .med-print-toolbar {
        display: none;
    }

    .med-print-preview {
        padding: 0;
        box-shadow: none;
    }

    .med-print-page {
        box-shadow: none;
    }
}
/* استایل‌های مخصوص پرینت */
@media print {
    body * {
        visibility: hidden;
    }
    
    .med-print-page, .med-print-page * {
        visibility: visible;
    }
    
    .med-print-page {
        position: absolute;
        left: 0;
        top: 0;
        width: 210mm;
        height: 297mm;
        margin: 0;
        padding: 20mm;
        box-shadow: none;
    }
    
    .med-print-toolbar {
        display: none;
    }
}

/* استایل‌های جدول در پرینت */
.med-print-table {
    width: 100%;
    border-collapse: collapse;
    margin: 15px 0;
}

.med-print-table th,
.med-print-table td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: right;
}

.med-print-table th {
    background-color: #f8f9fa;
    font-weight: bold;
}

/* استایل‌های گرید اطلاعات */
.med-print-info-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin: 15px 0;
}

.med-print-info-item {
    display: flex;
    gap: 10px;
}

.med-print-label {
    font-weight: bold;
    min-width: 120px;
}
/* استایل‌های عمومی */
.med-print-page {
    direction: rtl;
    padding: 20px;
    max-width: 800px;
    margin: 0 auto;
}

/* استایل‌های مخصوص پرینت */
@media print {
    body * {
        visibility: hidden;
    }
    
    .med-print-page,
    .med-print-page * {
        visibility: visible;
    }
    
    .med-print-page {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
    }
    
    .med-print-actions,
    .med-print-preview {
        display: none !important;
    }
    
    /* تنظیمات جدول‌ها برای پرینت */
    table {
        width: 100%;
        border-collapse: collapse;
        margin: 10px 0;
    }
    
    th, td {
        border: 1px solid #000;
        padding: 8px;
        text-align: right;
    }
}
.sub-nav {
    display: block; /* حالت پیش‌فرض برای تب اول */
    transition: all 0.3s ease; /* انیمیشن نرم برای مخفی/نمایش شدن */
}

.tab-content:not(#patient-info) .sub-nav {
    display: none; /* مخفی کردن نوبار فرعی در سایر تب‌ها */
}
.med-print-button-container {
    text-align: center;
    margin: 20px 0;
    direction: rtl;
}

.med-print-button {
    background-color: #4CAF50;
    border: none;
    color: white;
    padding: 12px 24px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 4px;
    font-family: 'Vazir', sans-serif;
}

.med-print-button:hover {
    background-color: #45a049;
}

@media print {
    .med-print-button-container {
        display: none;
    }
    
    .med-print-preview {
        display: block !important;
    }
    
    body {
        direction: rtl;
    }
}

/* اضافه کردن استایل‌های ضروری برای نمایش درست در حالت پرینت */
.med-print-preview {
    width: 100%;
    max-width: 210mm; /* اندازه کاغذ A4 */
    margin: 0 auto;
    padding: 20px;
    background: white;
}

.med-print-page {
    margin-bottom: 20px;
}

.med-print-table {
    width: 100%;
    border-collapse: collapse;
    margin: 10px 0;
}

.med-print-table th,
.med-print-table td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: right;
}

.med-print-table th {
    background-color: #f2f2f2;
}
        @media screen {
            .med-print-preview {
                max-width: 210mm;
                margin: 20px auto;
                padding: 20px;
                background: white;
                box-shadow: 0 0 10px rgba(0,0,0,0.1);
            }
        }

        @media print {
            .med-print-button-container {
                display: none !important;
            }
            
            body {
                background: white;
            }
            
            .med-print-preview {
                margin: 0;
                padding: 0;
            }
        }

        .med-print-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px;
            border-bottom: 2px solid #333;
        }

        .med-print-logo img {
            max-height: 100px;
        }

        .med-print-clinic-info {
            text-align: center;
        }

        .med-print-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .med-print-info-item {
            padding: 5px;
            border-bottom: 1px solid #eee;
        }

        .med-print-label {
            font-weight: bold;
            margin-left: 10px;
        }

        .med-print-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .med-print-table th,
        .med-print-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: right;
        }

        .med-print-table th {
            background-color: #f5f5f5;
        }

        .med-print-section {
            margin: 20px 0;
        }

        .med-print-footer {
            margin-top: 30px;
            padding-top: 10px;
            border-top: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
        }

        .med-print-button-container {
            text-align: center;
            margin: 20px 0;
        }

        .med-print-button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-family: inherit;
        }

        .med-print-button:hover {
            background-color: #45a049;
        }
        @media screen {
            .med-print-preview {
                max-width: 210mm;
                margin: 20px auto;
                padding: 20px;
                background: white;
                box-shadow: 0 0 10px rgba(0,0,0,0.1);
            }
        }

        @media print {
            .med-print-button-container {
                display: none !important;
            }
            
            body {
                background: white;
            }
            
            .med-print-preview {
                margin: 0;
                padding: 0;
            }
        }

        .med-print-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px;
            border-bottom: 2px solid #333;
        }

        .med-print-logo img {
            max-height: 100px;
        }

        .med-print-clinic-info {
            text-align: center;
        }

        .med-print-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .med-print-info-item {
            padding: 5px;
            border-bottom: 1px solid #eee;
        }

        .med-print-label {
            font-weight: bold;
            margin-left: 10px;
        }

        .med-print-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .med-print-table th,
        .med-print-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: right;
        }

        .med-print-table th {
            background-color: #f5f5f5;
        }

        .med-print-section {
            margin: 20px 0;
        }

        .med-print-footer {
            margin-top: 30px;
            padding-top: 10px;
            border-top: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
        }

        .med-print-button-container {
            text-align: center;
            margin: 20px 0;
        }

        .med-print-button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-family: inherit;
        }

        .med-print-button:hover {
            background-color: #45a049;
        }
  .visit-type-radio {
        display: flex;
        gap: 10px;
        padding: 5px;
    }

    .radio-label-custom {
        display: flex;
        align-items: center;
        cursor: pointer;
        font-size: 0.9em;
    }

    .radio-input-custom {
        margin-left: 4px;
    }

    .radio-text {
        margin-right: 4px;
    }

    /* برای اطمینان از عدم شکستن لایوت جدول */
    .treatment-table td .visit-type-radio {
        white-space: nowrap;
        min-width: 150px;
    }
     .lab-content {
        padding: 20px;
    }

    .lab-form-container {
        background: #fff;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .form-row {
        display: flex;
        gap: 20px;
        margin-bottom: 15px;
    }

    .form-group {
        flex: 1;
    }

    .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }

    .form-group input,
    .form-group select {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
    }

    .status-row {
        justify-content: flex-start;
        gap: 40px;
    }

    .checkbox-group {
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .save-lab-btn {
        background: #4CAF50;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    .lab-table {
        width: 100%;
        border-collapse: collapse;
    }

    .lab-table th,
    .lab-table td {
        padding: 12px;
        border: 1px solid #ddd;
        text-align: center;
    }

    .lab-table th {
        background: #f5f5f5;
    }

    .delete-btn {
        background: #ff4444;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
    }

    .text-success {
        color: #4CAF50;
    }

    .text-danger {
        color: #ff4444;
    }
    .dental-chart-container {
        width: 600px;
        margin: 20px auto;
    }

    .tooth-name-display {
        margin-bottom: 20px;
        display: flex;
        gap: 10px;
    }

    .tooth-name-display input {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
    }

    .dental-chart {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .jaw {
        display: flex;
        /*justify-content: center;*/
        gap: 10px;
    }

    .quadrant {
        display: flex;
        gap: 5px;
    }

    .tooth-lab {
        width: 40px;
        height: 40px;
        border: 2px solid #ccc;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        border-radius: 4px;
        font-size: 14px;
        transition: all 0.3s;
    }

    .tooth-lab:hover {
        background-color:rgb(197, 164, 164);
    }

    .tooth-lab.selected {
        background-color: #4CAF50;
        color: white;
        border-color: #45a049;
    }
    .tooth-lab.selected:hover {
    background-color: #45a049 !important;
}
    /* استایل‌های قبلی به اضافه: */
.tooth-lab.selected {
    background-color: #4CAF50;
    color: white;
    border-color: #45a049;
    animation: pulse 1s infinite;
}

@keyframes pulse {
    0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7);
    }
    70% {
        transform: scale(1.05);
        box-shadow: 0 0 0 10px rgba(76, 175, 80, 0);
    }
    100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(76, 175, 80, 0);
    }
}

.payment-table-container {
    margin-top: 30px;
    overflow-x: auto;
}

.payment-table {
    width: 100%;
    border-collapse: collapse;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.payment-table th,
.payment-table td {
    padding: 12px;
    text-align: center;
    border: 1px solid #ddd;
}

.payment-table th {
    background-color: #f5f5f5;
    font-weight: bold;
}

.action-buttons {
    display: flex;
    gap: 5px;
    justify-content: center;
}

.btn {
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 5px;
    transition: all 0.3s;
}

.pay-btn {
    background-color: #4CAF50;
    color: white;
}

.print-btn {
    background-color: #2196F3;
    color: white;
}

.invoice-btn {
    background-color: #ff9800;
    color: white;
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
}

.modal-content {
    background-color: white;
    margin: 10% auto;
    padding: 20px;
    width: 80%;
    max-width: 600px;
    border-radius: 8px;
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    z-index: 1000;
}

.modal-content {
    background-color: white;
    margin: 5% auto;
    padding: 20px;
    width: 80%;
    max-width: 800px;
    border-radius: 8px;
    position: relative;
}

.close-modal {
    position: absolute;
    right: 20px;
    top: 10px;
    font-size: 24px;
    cursor: pointer;
}

.modal-footer {
    margin-top: 20px;
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}
.invoice-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    direction: rtl;
}

.invoice-table th,
.invoice-table td {
    border: 1px solid #000;
    padding: 8px;
    text-align: center;
}

.invoice-table th {
    background-color: #f5f5f5;
    font-weight: bold;
}

.debit-row {
    background-color: #fff;
}

.credit-row {
    background-color: #f9f9f9;
}

.remaining-row {
    background-color: #f0f0f0;
    font-weight: bold;
}

.signature-box {
    margin-top: 50px;
    text-align: center;
}

.signature-line {
    width: 200px;
    height: 1px;
    background-color: #000;
    margin: 50px auto 0;
}

@media print {
    .modal-footer,
    .close-modal {
        display: none !important;
    }

    .invoice-printable {
        padding: 20px;
    }

    .invoice-table {
        page-break-inside: avoid;
    }
}
@media print {
    body * {
        visibility: hidden;
    }
    .printable-invoice, .printable-invoice * {
        visibility: visible;
    }
    .printable-invoice {
        position: absolute;
        left: 0;
        top: 0;
    }
}
.jaw-selection-buttons {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    justify-content: center;
}

.select-jaw-btn {
    background-color: #3498db;
    color: white;
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
}

.select-jaw-btn:hover {
    background-color: #2980b9;
    transform: translateY(-2px);
}

.select-jaw-btn i {
    font-size: 1.2em;
}

/* انیمیشن برای دکمه‌ها */
.select-jaw-btn:active {
    transform: translateY(1px);
}
    </style>
</head>
<body>
    <!-- Main Navigation -->
    <nav class="main-nav">
        <div class="nav-tabs">
            <div class="nav-tab active" data-tab="patient-info" data-tooltip="مشخصات بیمار">
                <i class="fas fa-user"></i>
                <span>مشخصات بیمار</span>
            </div>
            <div class="nav-tab" data-tab="attachments" data-tooltip="ضمایم">
                <i class="fas fa-paperclip"></i>
                <span>ضمایم</span>
            </div>
            <div class="nav-tab" data-tab="treatment" data-tooltip="درمان">
                <i class="fas fa-tooth"></i>
                <span>درمان</span>
            </div>
            <div class="nav-tab" data-tab="lab-tab" data-tooltip=" لابراتوار ">
                <i class="fas fa-clipboard-list"></i>
                <span> لابراتوار </span>
            </div>
            <div class="nav-tab" data-tab="prescription" data-tooltip="نسخه نویسی">
                <i class="fas fa-prescription"></i>
                <span>نسخه نویسی</span>
            </div>
            <div class="nav-tab" data-tab="payment" data-tooltip="پرداخت">
                <i class="fas fa-credit-card"></i>
                <span>پرداخت</span>
            </div>
            <div class="nav-tab" data-tab="points" data-tooltip="امتیازات">
                <i class="fas fa-star"></i>
                <span>امتیازات</span>
            </div>
        </div>
    </nav>

   
<div class="content-area">
    <div class="tab-content active" id="patient-info">
        
        <!-- زیرنوار در تب مشخصات بیمار -->
        <nav class="sub-nav">
            <div class="sub-nav-tabs">
                <div class="sub-nav-tab active" data-sub-tab="patient-details">اطلاعات بیمار</div>
                <div class="sub-nav-tab" data-sub-tab="edit-profile">ویرایش پرونده</div>
                <div class="sub-nav-tab" data-sub-tab="insurance-info">مشخصات بیمه</div>
                <div class="sub-nav-tab" data-sub-tab="additional-info">اطلاعات تکمیلی</div>
                <div class="sub-nav-tab" data-sub-tab="print-management"> پرینت پرونده </div>
            </div>
        </nav>

        <!-- محتوای زیرنوار -->
        <div class="sub-tab-content patient-subtab-content" id="patient-details">
    <!-- محتوای اطلاعات بیمار -->
          <!-- Patient Profile -->
        <div class="patient-profile">
            <div class="profile-image">
                <img src="default-avatar.jpg" alt="تصویر بیمار">
            </div>

            <div class="patient-info-grid">
                <div class="info-group">
                    <div class="info-label">شماره پرونده</div>
                    <div class="info-value">12345</div>
                </div>
                <div class="info-group">
                    <div class="info-label">نام و نام خانوادگی</div>
                    <div class="info-value">علی محمدی</div>
                </div>
                <div class="info-group">
                    <div class="info-label">کد ملی</div>
                    <div class="info-value">0123456789</div>
                </div>
                <div class="info-group">
                    <div class="info-label">شماره تماس</div>
                    <div class="info-value">09123456789</div>
                </div>
                <div class="info-group">
                    <div class="info-label">نام پدر</div>
                    <div class="info-value">محمد</div>
                </div>
                <div class="info-group">
                    <div class="info-label"> گروه خونی  </div>
                    <div class="info-value">A+</div>
                </div>
                <div class="info-group">
                    <div class="info-label"> ایمیل </div>
                    <div class="info-value">test@gmail.com</div>
                </div>
                <div class="info-group">
                    <div class="info-label">  شغل  </div>
                    <div class="info-value">  آزاد </div>
                </div>
                <div class="info-group">
                    <div class="info-label">شماره اضطراری</div>
                    <div class="info-value">09187654321</div>
                </div>
                <div class="info-group">
                    <div class="info-label">تاریخ تولد</div>
                    <div class="info-value">1370/01/01</div>
                </div>
                <div class="info-group">
                    <div class="info-label">وضعیت بیمه</div>
                    <div class="info-value">
                        <span class="status-badge status-active">فعال</span>
                    </div>
                </div>
                <div class="info-group">
                    <div class="info-label">جنسیت</div>
                    <div class="info-value">مرد</div>
                </div>
                <div class="info-group">
                    <div class="info-label">دسته‌بندی</div>
                    <div class="info-value">عادی</div>
                </div>
            </div>
        </div>
    

    <!-- Medical History -->
    <div class="medical-history">
        <h3 class="history-title">سوابق پزشکی</h3>
        <div class="history-grid">
            <div class="history-item">
                <div class="info-label">سابقه بیماری‌های خاص</div>
                <div class="info-value">دیابت نوع 2</div>
            </div>
            <div class="history-item">
                <div class="info-label">حساسیت‌های دارویی</div>
                <div class="info-value">پنی‌سیلین</div>
            </div>
            <div class="history-item">
                <div class="info-label">داروهای مصرفی فعلی</div>
                <div class="info-value">متفورمین</div>
            </div>
            <div class="history-item">
                <div class="info-label">قد (سانتی‌متر)</div>
                <div class="info-value">175</div>
            </div>
            <div class="history-item">
                <div class="info-label">وزن (کیلوگرم)</div>
                <div class="info-value">75</div>
            </div>
            <div class="history-item">
                <div class="info-label">میزان استرس دندانپزشکی</div>
                <div class="info-value">متوسط</div>
            </div>
            <div class="history-item">
                <div class="info-label">وضعیت اعتیاد</div>
                <div class="info-value">ندارد</div>
            </div>
            <div class="history-item">
                <div class="info-label">معرف</div>
                <div class="info-value">دکتر رضایی</div>
            </div>
        </div>
    </div>
    </div>
</div>
<!-- فرم ویرایش پروفایل -->
<div class="sub-tab-content edit-profile-container" id="edit-profile">
    <form class="edit-profile-form">
        <div class="form-grid">
            <!-- اطلاعات اصلی -->
            <div class="form-group">
                <label>شماره پرونده</label>
                <input type="text" class="edit-input" value="12345" readonly>
            </div>
            <div class="form-group">
                <label>نام و نام خانوادگی *</label>
                <input type="text" class="edit-input" value="علی محمدی" required>
            </div>
            <div class="form-group">
                <label>کد ملی *</label>
                <input type="text" class="edit-input" value="0123456789" required 
                       pattern="[0-9]{10}" maxlength="10">
            </div>
            <div class="form-group">
                <label>نام پدر</label>
                <input type="text" class="edit-input" value="محمد">
            </div>
            <div class="form-group">
                <label>تاریخ تولد *</label>
                <div class="date-input-container">
                    <input type="text" class="edit-input date-input" value="1370/01/01" required>
                    <i class="fas fa-calendar-alt"></i>
                </div>
            </div>
            <div class="form-group">
                <label>جنسیت *</label>
                <select class="edit-input" required>
                    <option value="male" selected>مرد</option>
                    <option value="female">زن</option>
                </select>
            </div>

            <!-- اطلاعات تماس -->
            <div class="form-group">
                <label>شماره تماس *</label>
                <input type="tel" class="edit-input" value="09123456789" 
                       pattern="09[0-9]{9}" maxlength="11" required>
            </div>
            <div class="form-group">
                <label>شماره تماس اضطراری</label>
                <input type="tel" class="edit-input" value="09187654321" 
                       pattern="09[0-9]{9}" maxlength="11">
            </div>
            <div class="form-group">
                <label>آدرس ایمیل</label>
                <input type="email" class="edit-input" value="example@mail.com">
            </div>

           

            <!-- اطلاعات تکمیلی -->
            <div class="form-group">
                <label>گروه خونی</label>
                <select class="edit-input">
                    <option value="">انتخاب کنید</option>
                    <option value="A+">A+</option>
                    <option value="A-">A-</option>
                    <option value="B+">B+</option>
                    <option value="B-">B-</option>
                    <option value="O+">O+</option>
                    <option value="O-">O-</option>
                    <option value="AB+">AB+</option>
                    <option value="AB-">AB-</option>
                </select>
            </div>
            <div class="form-group">
                <label>وضعیت تأهل</label>
                <select class="edit-input">
                    <option value="single">مجرد</option>
                    <option value="married">متأهل</option>
                </select>
            </div>
            <div class="form-group">
                <label> وضعیت بیمه  </label>
                <select class="edit-input">
                    <option value="single">فعال</option>
                    <option value="married">غیر فعال</option>
                </select>
            </div>
            <div class="form-group">
                <label> اعتیاد </label>
                <select class="edit-input">
                    <option value="single">دارد</option>
                    <option value="married">ندارد</option>
                </select>
            </div>
              <div class="form-group">
                    <label>وزن</label>
                <input type="number" class="edit-input">
            </div>
            <div class="form-group">
                    <label>معرف</label>
                <input type="text" class="edit-input">
            </div>
            <div class="form-group">
                <label>شغل</label>
                <input type="text" class="edit-input">
            </div>
                <div class="form-group">
                    <label>قد</label>
                <input type="number" class="edit-input">
                
            </div>
        </div>
        <!-- بخش بیماری‌های خاص و حساسیت‌ها -->
        <div class="medical-info-section">
            <h3>سوابق پزشکی</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label>بیماری‌های خاص</label>
                    <textarea class="edit-input" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label>آدرس محل سکونت</label>
                    <textarea class="edit-input" rows="3"></textarea>
            </div>
                <div class="form-group">
                    <label>حساسیت‌های دارویی</label>
                    <textarea class="edit-input" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label>میزان استرس دندانپزشکی</label>
                    <textarea class="edit-input" rows="2"></textarea>
                </div>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="save-btn">
                <i class="fas fa-save"></i>
                ذخیره تغییرات
            </button>
            <button type="reset" class="cancel-btn">
                <i class="fas fa-times"></i>
                انصراف
            </button>
        </div>
    </form>
</div>


<!-- فرم اطلاعات بیمه -->
<div class="sub-tab-content insurance-info-container" id="insurance-info">
    <!-- فرم ثبت اطلاعات بیمه -->
     <div class="form-group-insurance">
<div class="form-group">
    <label>نوع بیمه *</label>
    <select class="insurance-input" id="insuranceType" required>
        <option value="">انتخاب کنید</option>
        <option value="percentage">بیمه درصدی</option>
        <option value="tariff">بیمه تعرفه ای</option>
        <option value="total">کلی</option>
    </select>
</div>
<div class="form-group">
    <label>نام بیمه‌گر *</label>
    <select class="insurance-input" id="insuranceProvider" required disabled>
        <option value="">ابتدا نوع بیمه را انتخاب کنید</option>
    </select>
</div>

            <div class="form-group">
                <label>شماره بیمه‌نامه *</label>
                <input type="text" class="insurance-input" required>
            </div>
            <div class="form-group">
                <label>تاریخ اعتبار از *</label>
                <div class="date-input-container">
                    <input type="text" class="insurance-input date-input" required>
                    <i class="fas fa-calendar-alt"></i>
                </div>
            </div>
            <div class="form-group">
                <label>تاریخ اعتبار تا *</label>
                <div class="date-input-container">
                    <input type="text" class="insurance-input date-input" required>
                    <i class="fas fa-calendar-alt"></i>
                </div>
            </div>
            <div class="form-group">
                <label>سقف بیمه (ریال) *</label>
                <input type="number" class="insurance-input" required>
            </div>
            <div class="form-group">
                <label>درصد پوشش بیمه (فقط برای بیمه درصدی )</label>
                <input type="number" class="insurance-input" min="0" max="100" required>
            </div>
            <div class="form-group">
                <label>نام بیمه شده*</label>
                <input type="text" class="insurance-input" required>
            </div>
        </div>

        <div class="insurance-status-group">
            <label class="status-checkbox">
                <input type="checkbox" name="is_active"> فعال
            </label>
            <label class="status-checkbox">
                <input type="checkbox" name="is_sent"> ارسال شده به بیمه
            </label>
            <label class="status-checkbox">
                <input type="checkbox" name="is_received"> دریافت شده از بیمه
            </label>
            <label class="status-checkbox">
                <input type="checkbox" name="is_rejected"> رد شده از طرف بیمه
            </label>
        </div>

        <div class="form-actions">
            <button type="submit" class="save-btn">
                <i class="fas fa-save"></i>
                ثبت اطلاعات بیمه
            </button>
        </div>
    </form>

    <!-- جدول سوابق بیمه -->
    <div class="insurance-records">
        <h3>سوابق بیمه</h3>
        <div class="table-container">
            <table class="insurance-table">
                <thead>
                    <tr>
                        <th>نوع بیمه</th>
                        <th>نام بیمه‌گر</th>
                        <th>شماره بیمه</th>
                        <th> نام بیمه شده </th>
                        <th>تاریخ اعتبار از</th>
                        <th>تاریخ اعتبار تا</th>
                        <th>درصد پوشش</th>
                        <th> سقف بیمه </th>
                        <th>وضعیت</th>
                        <th>عملیات</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- نمونه ردیف -->
                    <tr>
                        <td>بیمه اصلی</td>
                        <td>تأمین اجتماعی</td>
                        <td>123456</td>
                        <td> محمد محمدی </td>
                        <td>1402/01/01</td>
                        <td>1403/01/01</td>
                        <td>70%</td>
                        <td> 150000000 </td>
                        <td class="status-cell">
                            <div class="status-toggles">
                                فعال
                                <label class="toggle-switch" title="فعال">
                                    
                                    <input type="checkbox" class="status-toggle" data-type="active" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                ارسال شده
                                <label class="toggle-switch" title="ارسال شده">
                                    <input type="checkbox" class="status-toggle" data-type="sent">
                                    <span class="toggle-slider"></span>
                                </label>
                                دریافت شده
                                <label class="toggle-switch" title="دریافت شده">
                                    <input type="checkbox" class="status-toggle" data-type="received">
                                    <span class="toggle-slider"></span>
                                </label>
                                رد شده
                                <label class="toggle-switch" title="رد شده">
                                    <input type="checkbox" class="status-toggle" data-type="rejected">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </td>
                        <td class="actions-cell">
                            <button class="edit-btn" title="ویرایش">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="delete-btn" title="حذف">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</div>
<!-- اطلاعات تکمیلی -->
<div class="sub-tab-content additional-info-container" id="additional-info">
    <form class="previous-treatment-form">
<div class="med-add-info-container" id="additional-info">
    <div class="med-add-info-section">
        <div class="med-add-info-header">
            <h3>ثبت سوابق درمانی قبلی</h3>
        </div>
        
        <form class="med-add-info-form">
            <div class="med-add-info-form-row">
                <div class="med-add-info-form-group">
                    <label>نام پزشک قبلی</label>
                    <input type="text" class="med-add-info-input" placeholder="نام پزشک معالج قبلی را وارد کنید">
                </div>
                <div class="med-add-info-form-group">
                    <label>تاریخ مراجعه</label>
                    <div class="med-add-info-date-container">
                        <input type="text" class="med-add-info-input med-add-info-date" placeholder="تاریخ مراجعه را وارد کنید">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                </div>
            </div>

            <div class="med-add-info-form-group">
                <label>شرح درمان‌های انجام شده</label>
                <textarea class="med-add-info-input med-add-info-textarea" 
                          rows="4" 
                          placeholder="توضیحات مربوط به درمان‌های انجام شده را وارد کنید"></textarea>
            </div>

            <div class="med-add-info-actions">
                <button type="submit" class="med-add-info-submit">
                    <i class="fas fa-plus"></i>
                    ثبت اطلاعات
                </button>
            </div>
        </form>
    </div>

    <div class="med-add-info-history">
        <div class="med-add-info-header">
            <h3>سوابق درمانی ثبت شده</h3>
            <div class="med-add-info-header-actions">
                <div class="med-add-info-search">
                    <input type="text" placeholder="جستجو در سوابق...">
                    <i class="fas fa-search"></i>
                </div>
            </div>
        </div>

        <div class="med-add-info-table-wrapper">
            <table class="med-add-info-table">
                <thead>
                    <tr>
                        <th>تاریخ مراجعه</th>
                        <th>نام پزشک</th>
                        <th>شرح درمان</th>
                        <th>عملیات</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1402/08/15</td>
                        <td>دکتر محمدی</td>
                        <td class="med-add-info-details">
                            <div class="med-add-info-text">عصب کشی دندان عقل سمت راست</div>
                        </td>
                        <td class="med-add-info-actions-cell">
                            <button class="med-add-info-btn med-add-info-edit" title="ویرایش">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="med-add-info-btn med-add-info-delete" title="حذف">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

    </div>
</div>

<!-- tab print -->
<div class="med-print-container sub-tab-content insurance-info-container" id="print-management">
    <div class="med-print-toolbar">
        <div class="med-print-pages">
            <span>تعداد صفحات:</span>
            <span class="med-print-page-count">3</span>
        </div>

    <div class="med-print-actions">
        <div class="med-print-btn-group">
                <button class="med-print-btn" onclick="openPrintPreview_pation_file()">
                    <i class="fas fa-print"></i>
                    پرینت مستقیم
                </button>
                <button class="med-print-btn" onclick="previewPrint()">
                    <i class="fas fa-eye"></i>
                    پیش‌نمایش پرینت
                </button>
        </div>

        <div class="med-print-dropdown">
                <button class="med-print-btn med-print-dropdown-toggle">
                    <i class="fas fa-download"></i>
                    ذخیره فایل
                    <i class="fas fa-chevron-down"></i>
                </button>
            <div class="med-print-dropdown-menu">
                    <button onclick="exportToExcel()">
                        <i class="fas fa-file-excel"></i>
                        ذخیره در Excel
                    </button>
                    <button onclick="exportToWord()">
                        <i class="fas fa-file-word"></i>
                        ذخیره در Word
                    </button>
                    <button onclick="exportToPDF()">
                        <i class="fas fa-file-pdf"></i>
                        ذخیره در PDF
                    </button>
            </div>
        </div>
    </div>

     <div class="med-print-preview" id="printArea">
        <div class="med-print-page">
                <div class="med-print-header">
                        <div class="med-print-logo">
                            <img src="logo.png" alt="لوگو کلینیک">
                        </div>
                    <div class="med-print-clinic-info">
                        <h2>کلینیک دندانپزشکی</h2>
                        <p>آدرس: تهران، خیابان ...</p>
                        <p>تلفن: 021-XXXXXXXX</p>
                        </div>
                    </div>
             <div class="med-print-section">
            <h3>مشخصات بیمار</h3>
            <div class="med-print-info-grid">
                <div class="med-print-info-item">
                    <span class="med-print-label">شماره پرونده:</span>
                    <span class="med-print-value" id="print-file-number">12345</span>
                </div>
                <div class="med-print-info-item">
                    <span class="med-print-label">نام و نام خانوادگی:</span>
                    <span class="med-print-value" id="print-fullname">علی محمدی</span>
                </div>
                <div class="med-print-info-item">
                    <span class="med-print-label">کد ملی:</span>
                    <span class="med-print-value" id="print-national-id">0123456789</span>
                </div>
                <div class="med-print-info-item">
                    <span class="med-print-label">نام پدر:</span>
                    <span class="med-print-value" id="print-father-name">محمد</span>
                </div>
                <div class="med-print-info-item">
                    <span class="med-print-label">تاریخ تولد:</span>
                    <span class="med-print-value" id="print-birth-date">1370/01/01</span>
                </div>
                <div class="med-print-info-item">
                    <span class="med-print-label">شماره تماس:</span>
                    <span class="med-print-value" id="print-phone">09123456789</span>
                </div>
                <div class="med-print-info-item">
                    <span class="med-print-label">شماره اضطراری:</span>
                    <span class="med-print-value" id="print-emergency">09187654321</span>
                </div>
                <div class="med-print-info-item">
                    <span class="med-print-label">آدرس:</span>
                    <span class="med-print-value" id="print-address">تهران، خیابان ...</span>
                </div>
            </div>
        </div>


        <div class="med-print-section">
            <h3>اطلاعات بیمه</h3>
            <table class="med-print-table" id="print-insurance-table">
                <thead>
                    <tr>
                        <th>نوع بیمه</th>
                        <th>نام بیمه‌گر</th>
                        <th>شماره بیمه</th>
                        <th>تاریخ اعتبار</th>
                        <th>درصد پوشش</th>
                        <th>وضعیت</th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </div>

        <div class="med-print-section">
            <h3>سوابق درمانی</h3>
            <table class="med-print-table" id="print-treatment-table">
                <thead>
                    <tr>
                        <th>تاریخ</th>
                        <th>نام پزشک</th>
                        <th>شرح درمان</th>
                    </tr>
                </thead>
                <tbody>
                   
                </tbody>
            </table>
        </div>

        
        <div class="med-print-footer">
            <div class="med-print-date">تاریخ چاپ: <span id="print-date"></span></div>
            <div class="med-print-page-number">صفحه <span class="page-num"></span></div>
        </div>
    </div>
    </div>        
    </div>
    <div class="med-print-button-container">
    <button onclick="printMedicalRecord()" class="med-print-button">پرینت پرونده پزشکی</button>
</div>
    </div>
    </div>
                </div>
</div>




        

    
<!--tab zamayem-->
<div class="tab-content" id="attachments">
    <div class="attachment-container">
        <!-- Toolbar -->
        <div class="attachment-toolbar">
            <button class="attachment-btn attachment-btn-primary">
                <i class="fas fa-plus"></i>
                جدید
            </button>
            <button class="attachment-btn attachment-btn-danger">
                <i class="fas fa-trash"></i>
                حذف
            </button>
            <button class="attachment-btn attachment-btn-secondary">
                <i class="fas fa-print"></i>
                پرینت عکس‌ها
            </button>
        </div>

        <!-- Images Grid -->
        <div class="attachment-grid">
            <!-- Sample Attachment Item -->
            <div class="attachment-item">
                <div class="attachment-checkbox">
                    <input type="checkbox" name="attachment[]" value="1">
                </div>
                <img src="sample1.jpg" alt="تصویر" class="attachment-image">
                <div class="attachment-info">
                    <div class="attachment-name">رادیوگرافی دندان</div>
                    <div class="attachment-date">1402/05/12</div>
                </div>
            </div>
            <!-- More attachment items can be added here -->
                 <!-- Modal for Image Preview -->
    <div class="attachment-modal">
        <div class="attachment-modal-content">
            <button class="attachment-modal-close">
                <i class="fas fa-times"></i>
            </button>
            <img src="" alt="نمایش تصویر" class="attachment-modal-image">
        </div>
    </div>
    
</div>
        </div>
    </div>


<!--tab darman-->

<div class="tab-content" id="treatment">
    <div class="treatment-container">
        <!-- Numbering System Selection -->
<div class="dental-numbering-system">
    <label class="dental-radio-label">
        <input type="radio" name="numberingSystem" value="iranian" checked>
        سیستم شماره‌گذاری ایرانی
    </label>
    <label class="dental-radio-label">
        <input type="radio" name="numberingSystem" value="american">
        سیستم شماره‌گذاری آمریکایی
    </label>
</div>

<!-- Quick Selection Buttons -->
<div class="dental-quick-select">
    <button class="dental-select-btn" data-select="all">انتخاب همه دندان‌ها</button>
    <button class="dental-select-btn" data-select="upper">انتخاب فک بالا</button>
    <button class="dental-select-btn" data-select="lower">انتخاب فک پایین</button>
</div>

<!-- Tooth Icon Modal -->
<div class="dental-icon-modal" id="toothIconModal">
    <div class="dental-modal-content">
        <div class="dental-modal-header">
            <h3>انتخاب وضعیت دندان</h3>
            <button class="dental-modal-close">&times;</button>
        </div>
        <div class="dental-modal-body">
            <div class="dental-icon-grid">
                <div class="dental-icon-option" data-icon="tooth">
                    <i class="fas fa-tooth"></i>
                    <span>دندان سالم</span>
                </div>
                <div class="dental-icon-option" data-icon="implant">
                    <i class="fas fa-teeth"></i>
                    <span>ایمپلنت</span>
                </div>
                <div class="dental-icon-option" data-icon="missing">
                    <i class="fas fa-times"></i>
                    <span>دندان از دست رفته</span>
                </div>
                <div class="dental-icon-option" data-icon="crown">
                    <i class="fas fa-crown"></i>
                    <span>روکش</span>
                </div>
                <div class="dental-icon-option" data-icon="bridge">
                    <i class="fas fa-grip-lines"></i>
                    <span>بریج</span>
                </div>
                <div class="dental-icon-option" data-icon="decay">
                    <i class="fas fa-bug"></i>
                    <span>پوسیدگی</span>
                </div>
                <div class="dental-icon-option" data-icon="filling">
                    <i class="fas fa-fill"></i>
                    <span>پر شده</span>
                </div>
                <div class="dental-icon-option" data-icon="root-canal">
                    <i class="fas fa-wave-square"></i>
                    <span>عصب کشی شده</span>
                </div>
                <div class="dental-icon-option" data-icon="extraction">
                    <i class="fas fa-minus-circle"></i>
                    <span>نیاز به کشیدن</span>
                </div>
                <div class="dental-icon-option" data-icon="done">
                    <i class="fas fa-check-circle"></i>
                    <span>درمان تکمیل</span>
                </div>
            </div>
            <div class="dental-tooth-notes">
                <label>یادداشت برای این دندان:</label>
                <textarea class="dental-tooth-note"></textarea>
            </div>
        </div>
    </div>
</div>

        <!-- Teeth Chart -->
<div class="dental-chart-wrapper">
    <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">1</span>
        </div>
        <!-- Repeat for teeth 2-16 -->
         </div>
            <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">2</span>
        </div>
        <!-- Repeat for teeth 2-16 -->
         </div>
            <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">3</span>
        </div>
        <!-- Repeat for teeth 2-16 -->  
        </div> 
        <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">4</span>
        </div>
        <!-- Repeat for teeth 2-16 -->
        </div> 
        <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">5</span>
        </div>
        <!-- Repeat for teeth 2-16 -->  
        </div>
        <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">6</span>
        </div>
        <!-- Repeat for teeth 2-16 --> 
        </div> 
        <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">7</span>
        </div>
        <!-- Repeat for teeth 2-16 -->  
        </div> 
        <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">8</span>
        </div>
        <!-- Repeat for teeth 2-16 --> 
        </div> 
        <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">9</span>
        </div>
        <!-- Repeat for teeth 2-16 -->  
        </div> 
        <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">10</span>
        </div>
        <!-- Repeat for teeth 2-16 --> 
        </div> 
        <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">11</span>
        </div>
        <!-- Repeat for teeth 2-16 -->  
        </div>
        <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">12</span>
        </div>
        <!-- Repeat for teeth 2-16 -->   
        </div> 
        <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">13</span>
        </div>
        <!-- Repeat for teeth 2-16 -->
        </div> 
        <!-- Upper Teeth -->
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">14</span>
        </div>
        <!-- Repeat for teeth 2-16 -->
         
    </div>
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">15</span>
        </div>
        <!-- Repeat for teeth 2-16 -->
         
    </div>
    <div class="dental-upper-row">
        <div class="dental-single-tooth" data-tooth="1">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">16</span>
        </div>
        <!-- Repeat for teeth 2-16 -->
         
    </div>


</div>
<br>
<hr>
<div class="dental-chart-wrapper">
    <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">1</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>
       <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">2</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">3</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">4</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">5</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">6</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">7</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">8</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">9</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">10</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">11</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">12</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">13</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">14</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>   <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">15</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>
       <!-- Lower Teeth -->
    <div class="dental-lower-row">
        <div class="dental-single-tooth" data-tooth="32">
            <div class="dental-tooth-icon">
                <i class="fas fa-tooth"></i>
            </div>
            <span class="dental-tooth-number">16</span>
        </div>
        <!-- Repeat for teeth 31-17 -->
    </div>
</div>
<div class="treatment-options">
    <div class="checkbox-group">
        <label class="treatment-checkbox">
            <input type="checkbox" id="is-treatment-plan">
            <span class="checkmark"></span>
            ثبت به عنوان طرح درمان
        </label>
    </div>
</div>
<div class="dental-treatment-types">
    <button class="dental-type-button" data-type="restoration">
        <i class="fas fa-fill-drip"></i>
        ترمیمی
    </button>
    <button class="dental-type-button" data-type="surgery">
        <i class="fas fa-cut"></i>
        جراحی
    </button>
    <button class="dental-type-button" data-type="root-canal">
        <i class="fas fa-stream"></i>
        عصب کشی
    </button>
    <button class="dental-type-button" data-type="prosthetics">
        <i class="fas fa-teeth"></i>
        پروتز
    </button>
    <button class="dental-type-button" data-type="orthodontics">
        <i class="fas fa-teeth-open"></i>
        ارتودنسی
    </button>
</div>
<!-- در بخش درمان -->
<!-- Treatment Description Section -->
<div class="dental-description-wrapper">
    <!-- Input for searching -->
    <div class="dental-search-box">
        <input type="text" class="dental-description-select" placeholder="جستجو در شرح درمان‌ها...">
        <i class="fas fa-search search-icon"></i>
    </div>

    <!-- Dropdown for treatment descriptions -->
    <div class="dental-description-dropdown">
        <!-- Restoration treatments -->
        <div class="dental-description-group" data-type="restoration">
            <div class="dental-description-item" data-general="150000" data-special="200000">ترمیم کامپوزیت کلاس یک</div>
            <div class="dental-description-item" data-general="180000" data-special="250000">ترمیم کامپوزیت کلاس دو</div>
            <div class="dental-description-item" data-general="120000" data-special="170000">ترمیم آمالگام</div>
        </div>
        
        <!-- Surgery treatments -->
        <div class="dental-description-group" data-type="surgery">
            <div class="dental-description-item" data-general="300000" data-special="400000">جراحی دندان عقل</div>
            <div class="dental-description-item" data-general="250000" data-special="350000">جراحی ریشه</div>
        </div>
        
        <!-- Add more treatment groups as needed -->
    </div>
</div>


<!-- Treatment Details Section -->
<div class="dental-treatment-details">
    <div class="dental-form-group">
        <label>تعرفه عمومی</label>
        <input type="text" class="dental-fee-input" id="generalFee" readonly>
    </div>
    <div class="dental-form-group">
        <label>تعرفه تخصصی</label>
        <input type="text" class="dental-fee-input" id="specialFee" readonly>
    </div>
</div>
       <!-- Treatment Form -->
        <form class="treatment-form">
            <div class="treatment-group">
                <label class="treatment-label">تعداد دندان انتخاب شده</label>
                <input type="text" class="treatment-input" id="selected-teeth" readonly>
            </div>


            <div class="treatment-group" style="display:none;">
                <label class="treatment-label">تعرفه عمومی درمان</label>
                <input type="number" class="treatment-input">
            </div>

            <div class="treatment-group" style="display:none;">
                <label class="treatment-label">تعرفه تخصصی درمان</label>
                <input type="number" class="treatment-input">
            </div>
            <div class="treatment-group">
                <label class="treatment-label">نوع تخفیف</label>
                <select class="treatment-select">
                    <option value="">انتخاب کنید</option>
                    <option value=""> از پزشک و کلینیک </option>
                    <option value=""> پزشک </option>
                    <option value=""> کلینیک </option>
                    <!-- Options will be populated dynamically -->
                </select>
            </div>

            <div class="treatment-group">
                <label class="treatment-label">تخفیف</label>
                <input type="number" class="treatment-input">
            </div>

            <div class="treatment-group">
                <label class="treatment-label">پزشک معالج</label>
                <select class="treatment-select">
                    <option value="">انتخاب کنید</option>
                    <!-- Options will be populated dynamically -->
                </select>
            </div>
            <div class="treatment-group">
                <label class="treatment-label">دستیار پزشک</label>
                <select class="treatment-select">
                    <option value="">انتخاب کنید</option>
                    <!-- Options will be populated dynamically -->
                </select>
            </div>

            <div class="treatment-group">
                    <label class="treatment-label" for="Visit-date">تاریخ مراجعه</label>
                    <input class="treatment-input" type="date" id="Visit-date" name="Visit-date" required>
            </div>
             <div class="treatment-group">
                    <label class="treatment-label" for="next-Visit-date">  تاریخ مراجعه بعدی </label>
                    <input class="treatment-input" type="date" id="next-Visit-date" name="next-Visit-date" required>
            </div>
            <div class="treatment-group">
                <label class="treatment-label">هزینه مواد</label>
                <input type="number" class="treatment-input">
            </div>

            <div class="treatment-group">
                <label class="treatment-label">هزینه لابراتوار</label>
                <input type="number" class="treatment-input">
            </div>

            <div class="treatment-group">
                <label class="treatment-label">مبلغ قابل پرداخت</label>
                <input type="number" class="treatment-input" readonly>
            </div>

            <div class="treatment-group">
                <label class="treatment-checkbox">
                    <input type="checkbox">
                    ارسال شده به بیمه
                </label>
            </div>

            <div class="treatment-group">
                <label class="treatment-checkbox">
                    <input type="checkbox">
                    درمان انجام شده
                </label>
            </div>

            <div class="treatment-group">
                <label class="treatment-checkbox">
                    <input type="checkbox">
                    از بیمه مبلغ دریافت شده
                </label>
            </div>
        </form>

        <button type="submit" class="treatment-submit">ثبت درمان</button>
<hr>
<!-- دکمه تنظیمات ستون‌ها -->
<div class="table-settings">
    <button class="settings-btn" onclick="openColumnSettings()">
        <i class="fas fa-cog"></i>
        تنظیمات نمایش ستون‌ها
    </button>
</div>

<!-- جدول درمان‌ها -->
<div class="treatment-table-container">
    <table class="treatment-table">
        <thead>
            <tr>
                <th>ردیف</th>
                <th>تاریخ</th>
                <th>شماره دندان</th>
                <th>نوع درمان</th>
                <th>شرح درمان</th>
                <th>پزشک معالج</th>
                <th>دستیار</th>
                <th>تعرفه عمومی</th>
                <th>تعرفه تخصصی</th>
                <th>تخفیف</th>
                <th>هزینه مواد</th>
                <th>هزینه لابراتور</th>
                <th>مبلغ قابل پرداخت</th>
                <th>وضعیت بیمه</th>
                <th>وضعیت درمان</th>
                <th>تاریخ مراجعه بعدی</th>
                <th>نوع مراجعه</th> 
                <th>عملیات</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>1402/08/25</td>
                <td>14, 15</td>
                <td>ترمیمی</td>
                <td>ترمیم کامپوزیت کلاس دو</td>
                <td>دکتر محمدی</td>
                <td>خانم رضایی</td>
                <td>850,000</td>
                <td>1,200,000</td>
                <td>100,000</td>
                <td>200,000</td>
                <td>0</td>
                <td>1,100,000</td>
                <td>ارسال شده</td>
                <td>انجام شده</td>
                <td>1402/09/01</td>
                 <td>
                    <div class="visit-type-radio">
                        <label class="radio-label-custom">
                            <input type="radio" name="visit_type_1" value="treatment" class="radio-input-custom">
                            <span class="radio-text">درمان</span>
                        </label>
                        <label class="radio-label-custom">
                            <input type="radio" name="visit_type_1" value="treatment_plan" class="radio-input-custom">
                            <span class="radio-text">طرح درمان</span>
                        </label>
                        <button class="action-btn edit" title="ذخیره">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>
                </td>
                <td>
                    <div class="action-buttons">
                        <button class="action-btn edit" title="ویرایش">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete" title="حذف">
                            <i class="fas fa-trash"></i>
                        </button>
                        <button class="action-btn print" title="پرینت">
                            <i class="fas fa-print"></i>
                        </button>
                        <button class="action-btn invoice" title="صدور فاکتور">
                            <i class="fas fa-file-invoice"></i>
                        </button>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<!-- مودال تنظیمات ستون‌ها -->
<div class="settings-modal" id="columnSettingsModal">
    <div class="settings-modal-content">
        <div class="settings-modal-header">
            <h3>تنظیمات نمایش ستون‌ها</h3>
            <button class="modal-close" onclick="closeColumnSettings()">&times;</button>
        </div>
        <div class="settings-modal-body">
            <div class="columns-list">
                <!-- ستون‌ها به صورت چک‌باکس -->
            </div>
        </div>
        <div class="settings-modal-footer">
            <button class="save-settings" onclick="saveColumnSettings()">ذخیره تنظیمات</button>
        </div>
    </div>
</div>

    </div>
</div>
</div>
</div>
<!--tab lab-->
<!-- Tab Treatment Plan -->
<div class="tab-content" id="lab-tab">
  <div class="lab-form-container">
        <!-- جدول نمایش اطلاعات -->
    <div class="lab-table-container">
        <div class="dental-chart-container">
            <!-- دکمه‌های انتخاب فک -->
<div class="jaw-selection-buttons">
    <button class="btn select-jaw-btn" onclick="selectAllTeeth()">
        <i class="fas fa-teeth"></i>
        انتخاب تمام دندان‌ها
    </button>
    <button class="btn select-jaw-btn" onclick="selectUpperJaw()">
        <i class="fas fa-tooth"></i>
        انتخاب فک بالا
    </button>
    <button class="btn select-jaw-btn" onclick="selectLowerJaw()">
        <i class="fas fa-tooth"></i>
        انتخاب فک پایین
    </button>
</div>
    <div class="dental-chart">
        <!-- فک بالا -->
        <div class="jaw upper-jaw">
            <div class="quadrant right">
                <div class="tooth-lab" data-tooth-number="18" data-tooth-name="Third Molar">18</div>
                <div class="tooth-lab" data-tooth-number="17" data-tooth-name="Second Molar">17</div>
                <div class="tooth-lab" data-tooth-number="16" data-tooth-name="First Molar">16</div>
                <div class="tooth-lab" data-tooth-number="15" data-tooth-name="Second Premolar">15</div>
                <div class="tooth-lab" data-tooth-number="14" data-tooth-name="First Premolar">14</div>
                <div class="tooth-lab" data-tooth-number="13" data-tooth-name="Canine">13</div>
                <div class="tooth-lab" data-tooth-number="12" data-tooth-name="Lateral Incisor">12</div>
                <div class="tooth-lab" data-tooth-number="11" data-tooth-name="Central Incisor">11</div>
            </div>
            <div class="quadrant left">
                <div class="tooth-lab" data-tooth-number="21" data-tooth-name="Central Incisor">21</div>
                <div class="tooth-lab" data-tooth-number="22" data-tooth-name="Lateral Incisor">22</div>
                <div class="tooth-lab" data-tooth-number="23" data-tooth-name="Canine">23</div>
                <div class="tooth-lab" data-tooth-number="24" data-tooth-name="First Premolar">24</div>
                <div class="tooth-lab" data-tooth-number="25" data-tooth-name="Second Premolar">25</div>
                <div class="tooth-lab" data-tooth-number="26" data-tooth-name="First Molar">26</div>
                <div class="tooth-lab" data-tooth-number="27" data-tooth-name="Second Molar">27</div>
                <div class="tooth-lab" data-tooth-number="28" data-tooth-name="Third Molar">28</div>
            </div>
        </div>

        <!-- فک پایین -->
        <div class="jaw lower-jaw">
            <div class="quadrant right">
                <div class="tooth-lab" data-tooth-number="48" data-tooth-name="Third Molar">48</div>
                <div class="tooth-lab" data-tooth-number="47" data-tooth-name="Second Molar">47</div>
                <div class="tooth-lab" data-tooth-number="46" data-tooth-name="First Molar">46</div>
                <div class="tooth-lab" data-tooth-number="45" data-tooth-name="Second Premolar">45</div>
                <div class="tooth-lab" data-tooth-number="44" data-tooth-name="First Premolar">44</div>
                <div class="tooth-lab" data-tooth-number="43" data-tooth-name="Canine">43</div>
                <div class="tooth-lab" data-tooth-number="42" data-tooth-name="Lateral Incisor">42</div>
                <div class="tooth-lab" data-tooth-number="41" data-tooth-name="Central Incisor">41</div>
            </div>
            <div class="quadrant left">
                <div class="tooth-lab" data-tooth-number="31" data-tooth-name="Central Incisor">31</div>
                <div class="tooth-lab" data-tooth-number="32" data-tooth-name="Lateral Incisor">32</div>
                <div class="tooth-lab" data-tooth-number="33" data-tooth-name="Canine">33</div>
                <div class="tooth-lab" data-tooth-number="34" data-tooth-name="First Premolar">34</div>
                <div class="tooth-lab" data-tooth-number="35" data-tooth-name="Second Premolar">35</div>
                <div class="tooth-lab" data-tooth-number="36" data-tooth-name="First Molar">36</div>
                <div class="tooth-lab" data-tooth-number="37" data-tooth-name="Second Molar">37</div>
                <div class="tooth-lab" data-tooth-number="38" data-tooth-name="Third Molar">38</div>
            </div>
        </div>
    </div>
</div>
<hr>
        <form class="lab-form">
            <div class="form-row">
                <div class="form-group">
                    <div class="tooth-name-display">
            
        <div class="input-group">
            <label>شماره دندان‌ها:</label>
            <input type="text" id="selected-teeth" readonly placeholder="دندان‌های انتخاب شده">
        </div>
        <div class="input-group">
            <label>نام علمی دندان‌ها:</label>
            <input type="text" id="teeth-names" readonly placeholder="نام علمی دندان‌ها">
        </div>
        <div class="input-group">
            <label>تعداد دندان‌ها:</label>
            <input type="text" id="teeth-count" readonly placeholder="تعداد">
        </div>
    </div>
    </div>
                </div>

                <div class="form-group">
                    <label>لابراتوار</label>
                    <select class="lab-select">
                        <option value="">انتخاب کنید</option>
                        <option value="lab1">لابراتوار 1</option>
                        <option value="lab2">لابراتوار 2</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>تلفن</label>
                    <input type="tel" class="lab-phone">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>تاریخ ارسال</label>
                    <input type="date" class="send-date">
                </div>

                <div class="form-group">
                    <label>تاریخ دریافت</label>
                    <input type="date" class="receive-date">
                </div>

                <div class="form-group">
                    <label>تاریخ یادآوری</label>
                    <input type="date" class="reminder-date">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>مبلغ (تومان)</label>
                    <input type="number" class="lab-cost">
                </div>

                <div class="form-group">
                    <label>طرف حساب</label>
                    <select class="payment-party">
                        <option value="patient">بیمار</option>
                        <option value="clinic">کلینیک</option>
                    </select>
                </div>
            </div>

            <div class="form-row status-row">
                <div class="form-group checkbox-group">
                    <input type="checkbox" id="sent-status">
                    <label for="sent-status">ارسال شده</label>
                </div>

                <div class="form-group checkbox-group">
                    <input type="checkbox" id="received-status">
                    <label for="received-status">دریافت شده</label>
                </div>
            </div>

            <button type="submit" class="save-lab-btn">ذخیره</button>
        </form>
    </div>
<div class="payment-table-container">
    <table class="payment-table">
    <thead>
        <tr>
            <th>ردیف</th>
            <th>شماره دندان</th>
            <th>نام دندان</th>
            <th>تاریخ</th>
            <th>بدهکار</th>
            <th>بستانکار</th>
            <th>مانده</th>
            <th>وضعیت</th>
            <th>عملیات</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>14, 15</td>
            <td>First Premolar, Second Premolar</td>
            <td>1402/08/25</td>
            <td>2,500,000</td>
            <td>1,500,000</td>
            <td>1,000,000</td>
            <td>در انتظار پرداخت</td>
            <td class="action-buttons">
                <button class="btn pay-btn" onclick="showPaymentModal()">
                    <i class="fas fa-money-bill"></i>
                    پرداخت
                </button>
                <button class="btn print-btn" onclick="printBill()">
                    <i class="fas fa-print"></i>
                    پرینت
                </button>
                <button class="btn invoice-btn" onclick="showInvoiceModal()">
                    <i class="fas fa-file-invoice"></i>
                    صدور فاکتور
                </button>
            </td>
        </tr>
    </tbody>
</table>

        <table class="lab-table">
            <thead>
                <tr>
                    <th>ردیف</th>
                    <th>شماره دندان</th>
                    <th>لابراتوار</th>
                    <th>تلفن</th>
                    <th>تاریخ ارسال</th>
                    <th>تاریخ دریافت</th>
                    <th>تاریخ یادآوری</th>
                    <th>مبلغ</th>
                    <th>طرف حساب</th>
                    <th>وضعیت ارسال</th>
                    <th>وضعیت دریافت</th>
                    <th>عملیات</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>14, 15</td>
                    <td>لابراتوار 1</td>
                    <td>09123456789</td>
                    <td>1402/08/25</td>
                    <td>1402/09/05</td>
                    <td>1402/09/01</td>
                    <td>2,500,000</td>
                    <td>بیمار</td>
                    <td><i class="fas fa-check text-success"></i></td>
                    <td><i class="fas fa-times text-danger"></i></td>
                    <td>
                        <button class="delete-btn" title="حذف">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    
</div>


<!--pardakht labratoar-->

<hr>
<div id="invoice-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>فاکتور رسمی</h2>
            <span class="close-modal">&times;</span>
        </div>
        <div class="invoice-content">
            <div class="invoice-printable" id="printable-invoice">
                <div class="invoice-header">
                    <div class="clinic-info">
                        <h2>کلینیک دندانپزشکی</h2>
                        <p>تاریخ: <span id="invoice-date"></span></p>
                    </div>
                </div>
                
                <div class="customer-info">
                    <p>نام بیمار: <span id="customer-name"></span></p>
                    <p>کد ملی: <span id="customer-id"></span></p>
                </div>

                <div class="invoice-details">
                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th>ش فاکتور</th>
                                <th>ش کل</th>
                                <th>ردیف</th>
                                <th>نوع حساب</th>
                                <th>بدهکار</th>
                                <th>بستانکار</th>
                                <th>مانده</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="debit-row">
                                <td rowspan="3" id="invoice-number"></td>
                                <td rowspan="3" id="total-number"></td>
                                <td>1</td>
                                <td>درمان دندان</td>
                                <td id="debit-amount">2,500,000</td>
                                <td>0</td>
                                <td>2,500,000</td>
                            </tr>
                            <tr class="credit-row">
                                <td>2</td>
                                <td>پرداخت نقدی</td>
                                <td>0</td>
                                <td id="credit-amount">1,500,000</td>
                                <td>1,000,000</td>
                            </tr>
                            <tr class="remaining-row">
                                <td>3</td>
                                <td>مانده</td>
                                <td>0</td>
                                <td>0</td>
                                <td id="remaining-amount">1,000,000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="invoice-footer">
                    <div class="signatures">
                        <div class="signature-box">
                            <p>مهر و امضای مسئول</p>
                            <div class="signature-line"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn print-invoice" onclick="printInvoice()">پرینت فاکتور</button>
            <button class="btn close-btn" onclick="closeInvoiceModal()">بستن</button>
        </div>
    </div>
</div>

</div>





<!-- tab Print Template (outside of tab content) -->
<div id="print-template" style="display: none;">
    <div class="print-page">
        <div class="print-header">
            <div class="clinic-logo">
                <i class="fas fa-tooth fa-3x"></i>
            </div>
            <div class="clinic-info">
                <h1>کلینیک تخصصی دندانپزشکی زیبادنت</h1>
                <p>دارای مجوز رسمی از وزارت بهداشت</p>
                <div class="clinic-details">
                    <p>تلفن: 021-12345678</p>
                    <p>آدرس: تهران، خیابان ولیعصر، کوچه مهر، پلاک 12</p>
                </div>
            </div>
        </div>

        <div class="patient-info">
            <div class="patient-header">
                <div class="patient-avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="patient-details">
                    <table>
                        <tr>
                            <th>نام و نام خانوادگی:</th>
                            <td>علی محمدی</td>
                            <th>شماره پرونده:</th>
                            <td>12345</td>
                        </tr>
                        <tr>
                            <th>تاریخ تولد:</th>
                            <td>1370/06/15</td>
                            <th>کد ملی:</th>
                            <td>0123456789</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <div class="treatment-plan-title">
            <h2>طرح درمان پیشنهادی</h2>
            <p class="plan-date">تاریخ: <span id="print-date"></span></p>
        </div>

        <div id="print-content">
            <!-- محتوای جدول اینجا به صورت پویا اضافه می‌شود -->
        </div>

        <div class="treatment-notes">
            <h3>توضیحات تکمیلی:</h3>
            <p>1. مدت زمان تقریبی انجام کل درمان‌ها: 3 جلسه</p>
            <p>2. اعتبار این طرح درمان: یک ماه از تاریخ صدور</p>
            <p>3. هزینه‌های لابراتوار جداگانه محاسبه می‌گردد</p>
        </div>

        <div class="print-footer">
            <div class="signatures">
                <div class="signature-box">
                    <p>پزشک معالج: <span id="print-doctor"></span></p>
                    <div class="signature-line">امضاء و مهر</div>
                </div>
                <div class="signature-box">
                    <p>تأیید بیمار</p>
                    <div class="signature-line">امضاء</div>
                </div>
            </div>
            <div class="clinic-footer">
                <p>www.zibadent.com | info@zibadent.com</p>
            </div>
        </div>
    </div>
</div>


<!--tab pardakht-->
<div class="tab-content" id="payment">
    <div class="payment-container">
        <!-- Current Treatments Table -->
<!-- اضافه کردن دکمه‌های پرینت به بالای جدول -->
<!-- دکمه‌های پرینت -->
<div class="print-buttons">
    <button class="payment-print-btn thermal" onclick="openPaymentPrintModal('thermal')">
        <i class="fas fa-receipt"></i>
        پرینت حرارتی
    </button>
    <button class="payment-print-btn normal" onclick="openPaymentPrintModal('normal')">
        <i class="fas fa-print"></i>
        پرینت معمولی
    </button>
</div>

<!-- مودال انتخاب فیلدهای پرینت پرداخت -->
<div class="payment-print-modal">
    <div class="payment-print-content">
        <div class="payment-print-header">
            <h3>انتخاب موارد برای پرینت</h3>
            <button class="payment-modal-close" onclick="document.querySelector('.payment-print-modal').style.display = 'none';">&times;</button>
        </div>
        <div class="payment-print-body">
            <div class="payment-print-group">
                <label class="payment-checkbox-container">
                    <input type="checkbox" class="payment-print-option" value="clinic-info" checked>
                    <span class="payment-checkmark"></span>
                    اطلاعات کلینیک
                </label>
                <label class="payment-checkbox-container">
                    <input type="checkbox" class="payment-print-option" value="patient-info" checked>
                    <span class="payment-checkmark"></span>
                    اطلاعات بیمار
                </label>
                <label class="payment-checkbox-container">
                    <input type="checkbox" class="payment-print-option" value="payment-details" checked>
                    <span class="payment-checkmark"></span>
                    جزئیات پرداخت
                </label>
                <label class="payment-checkbox-container">
                    <input type="checkbox" class="payment-print-option" value="treatment-info" checked>
                    <span class="payment-checkmark"></span>
                    اطلاعات درمان
                </label>
                <label class="payment-checkbox-container">
                    <input type="checkbox" class="payment-print-option" value="doctor-info" checked>
                    <span class="payment-checkmark"></span>
                    اطلاعات پزشک
                </label>
                <label class="payment-checkbox-container">
                    <input type="checkbox" class="payment-print-option" value="payment-method" checked>
                    <span class="payment-checkmark"></span>
                    روش پرداخت
                </label>
                <label class="payment-checkbox-container">
                    <input type="checkbox" class="payment-print-option" value="signatures" checked>
                    <span class="payment-checkmark"></span>
                    امضاها
                </label>
            </div>
            <div class="payment-print-actions">
                <button class="payment-print-btn-cancel" onclick="document.querySelector('.payment-print-modal').style.display = 'none';">انصراف</button>
                <button class="payment-print-btn-print" onclick="generatePaymentPrint()">پرینت</button>
            </div>
        </div>
    </div>
</div>




        <table class="payment-table">
            <thead>
                <tr>
                    <th>شرح درمان</th>
                    <th>درمان</th>
                    <th>پزشک معالج</th>
                    <th>بدهکار</th>
                    <th>مانده</th>
                    <th>بستانکار</th>
                    <th>عملیات</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>ترمیم دندان</td>
                    <td>ترمیمی</td>
                    <td>دکتر محمدی</td>
                    <td class="payment-amount">2,500,000</td>
                    <td class="payment-amount">1,500,000</td>
                    <td class="payment-amount">1,000,000</td>
                    <td>
                        <button class="payment-btn" onclick="openPaymentModal(this)" data-amount="1500000">
                            <i class="fas fa-credit-card"></i>
                            پرداخت
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Payment History -->
        <div class="payment-history">
            <h3 class="payment-history-title">سوابق پرداخت</h3>
            <table class="payment-table">
                <thead>
                    <tr>
                        <th>تاریخ واریز</th>
                        <th>مبلغ</th>
                        <th>نام پزشک</th>
                        <th>شرح درمان</th>
                        <th>درمان</th>
                        <th>تاریخ مراجعه</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Payment history rows -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="payment-modal">
        <div class="payment-modal-content">
            <div class="payment-modal-header">
                <h3 class="payment-modal-title">ثبت پرداخت جدید</h3>
                <button class="payment-modal-close" onclick="closePaymentModal()">&times;</button>
            </div>
            <form class="payment-form">
               <div class="payment-form-group">
    <label class="payment-label">نوع پرداخت</label>
    <select class="payment-select" id="paymentType" onchange="toggleInstallmentFields()">
        <option value="regular">عادی</option>
        <option value="installment">اقساطی</option>
    </select>
</div>

<!-- فیلدهای اقساط - در ابتدا مخفی هستند -->
<div id="installmentFields" style="display: none;">
    <div class="payment-form-group">
        <label class="payment-label">تعداد اقساط</label>
        <input type="number" class="payment-input" id="installmentCount" min="1">
    </div>
    
    <div class="payment-form-group">
        <label class="payment-label">مبلغ پیش پرداخت</label>
        <input type="number" class="payment-input" id="downPayment">
    </div>
    
    <div class="payment-form-group">
        <label class="payment-label">تاریخ قسط اول</label>
        <div class="date-input-container">
            <input type="date" class="payment-input" id="firstInstallmentDate" readonly>
            <i class="fas fa-calendar-alt calendar-icon"></i>
        </div>
    </div>
</div>

                <div class="payment-form-group">
                    <label class="payment-label">روش پرداخت</label>
                    <select class="payment-select" id="paymentMethod">
                        <option value="cash">نقد</option>
                        <option value="card">کارت به کارت</option>
                        <option value="pos">کارت خوان</option>
                        <option value="check">چک</option>
                        <option value="card">عودت</option>
                        <option value="pos"کیف پول</option>
                        <option value="transfer">واریز به حساب</option>
                    </select>
                </div>

                <div class="payment-check-fields" id="checkFields">
                    <div class="payment-form-group">
                        <label class="payment-label">شماره چک</label>
                        <input type="text" class="payment-input">
                    </div>
                    <div class="payment-form-group">
                        <label class="payment-label">تاریخ سررسید</label>
                        <input type="date" class="payment-input">
                    </div>
                    <div class="payment-form-group">
                        <label class="payment-label">شماره صیادی چک </label>
                        <input type="text" class="payment-input">
                    </div>
                    <div class="payment-form-group">
                        <label class="payment-label">مبلغ چک</label>
                        <input type="number" class="payment-input">
                    </div>
                    <div class="payment-form-group">
                        <label class="payment-checkbox">
                            <input type="checkbox">
                            پاس شده
                        </label>
                    </div>
                </div>

                <div class="payment-form-group">
                    <label class="payment-label">پزشک معالج</label>
                    <select class="payment-select">
                        <option value="">انتخاب کنید</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
                  <div class="payment-form-group">
                    <label class="payment-label">دستیار</label>
                    <select class="payment-select">
                        <option value="">انتخاب کنید</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
                <div class="payment-form-group">
                    <label class="payment-label"> دریافت کننده </label>
                    <select class="payment-select">
                        <option value="">انتخاب کنید</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
                <div class="payment-form-group">
                    <label class="payment-label"> تاریخ دریافت وجه </label>
                    <input type="date" class="payment-input" readonly>
                </div>
                <div class="payment-form-group">
                    <label class="payment-label">مبلغ قابل پرداخت</label>
                    <input type="number" class="payment-input" readonly>
                </div>

              

              

                <div class="payment-actions">
                    <button type="button" class="payment-btn" onclick="closePaymentModal()">بستن</button>
                    <button type="submit" class="payment-btn">ثبت پرداخت</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- tab noskhe nevisi-->
<div class="tab-content" id="prescription">
    <div style="padding: 20px; text-align: center; color: #666;">
        <i class="fas fa-prescription" style="font-size: 48px; margin-bottom: 15px;"></i>
        <p>این بخش در حال توسعه است...</p>
    </div>
</div>
<!-- tab emtiazat -->
 <div class="tab-content" id="points">
    <div class="points-container">
        <!-- Points Summary -->
        <div class="points-summary">
            <div class="points-card">
                <div class="points-card-title">امتیاز کل</div>
                <div class="points-card-value">1,250</div>
            </div>
            <div class="points-card">
                <div class="points-card-title">امتیاز قابل استفاده</div>
                <div class="points-card-value">850</div>
            </div>
            <div class="points-card">
                <div class="points-card-title">امتیاز استفاده شده</div>
                <div class="points-card-value">400</div>
            </div>
        </div>

        <!-- Points Filters -->
        <div class="points-filters">
            <button class="points-filter active">همه</button>
            <button class="points-filter">امتیازات دریافتی</button>
            <button class="points-filter">امتیازات مصرف شده</button>
            <button class="points-filter">تخفیف‌های فعال</button>
        </div>

        <!-- Points History -->
        <div class="points-history">
            <table class="points-table">
                <thead>
                    <tr>
                        <th>تاریخ</th>
                        <th>شرح</th>
                        <th>نوع</th>
                        <th>امتیاز</th>
                        <th>وضعیت</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1402/08/15</td>
                        <td>ویزیت دندانپزشکی</td>
                        <td>
                            <span class="points-badge points-earned">
                                <i class="fas fa-plus"></i>
                                دریافت
                            </span>
                        </td>
                        <td>100</td>
                        <td>تایید شده</td>
                    </tr>
                    <tr>
                        <td>1402/08/10</td>
                        <td>استفاده از تخفیف</td>
                        <td>
                            <span class="points-badge points-spent">
                                <i class="fas fa-minus"></i>
                                مصرف
                            </span>
                        </td>
                        <td>200</td>
                        <td>اعمال شده</td>
                    </tr>
                    <!-- More rows can be added here -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Tab contents will be here -->
    </div>
            <script>
            // Tab Switching Function
document.addEventListener('DOMContentLoaded', function() {
    const mainNavTabs = document.querySelectorAll('.nav-tab');
    const mainTabContents = document.querySelectorAll('.tab-content');
    const subNav = document.querySelector('.sub-nav');
    const subNavTabs = document.querySelectorAll('.sub-nav-tab');
    const subTabContents = document.querySelectorAll('.sub-tab-content');

    // فعال کردن تب و زیرتب اول به صورت پیش‌فرض
    mainNavTabs[0].classList.add('active');
    mainTabContents[0].classList.add('active');
    subNavTabs[0].classList.add('active');
    subTabContents[0].classList.add('active');

    mainNavTabs.forEach(mainTab => {
        mainTab.addEventListener('click', () => {
            const mainTabId = mainTab.dataset.tab;

            // غیرفعال کردن همه تب‌ها و زیرتب‌ها
            mainNavTabs.forEach(tab => tab.classList.remove('active'));
            mainTabContents.forEach(content => content.classList.remove('active'));
            subNavTabs.forEach(tab => tab.classList.remove('active'));
            subTabContents.forEach(content => content.classList.remove('active'));

            // فعال کردن تب اصلی و محتوای آن
            mainTab.classList.add('active');
            const mainTabContent = document.getElementById(mainTabId);
            mainTabContent.classList.add('active');

            // مدیریت نمایش زیر نوار و فعال کردن اولین زیرتب
            if (mainTabId === 'patient-info') {
                subNav.style.display = 'block';
                const firstSubTab = subNav.querySelector('.sub-nav-tab');
                const firstSubContent = document.getElementById(firstSubTab.dataset.subTab);
                firstSubTab.classList.add('active');
                firstSubContent.classList.add('active');
            } else {
                subNav.style.display = 'none';
            }
        });
    });

    subNavTabs.forEach(subTab => {
        subTab.addEventListener('click', () => {
            const subTabId = subTab.dataset.subTab;

            subNavTabs.forEach(tab => tab.classList.remove('active'));
            subTabContents.forEach(content => content.classList.remove('active'));

            subTab.classList.add('active');
            document.getElementById(subTabId).classList.add('active');
        });
    });
});


</script>
        <script>
document.addEventListener('DOMContentLoaded', function() {
    // Points Filter Functionality
    const filters = document.querySelectorAll('.points-filter');
    
    filters.forEach(filter => {
        filter.addEventListener('click', () => {
            filters.forEach(f => f.classList.remove('active'));
            filter.classList.add('active');
            
            // Here you can add filter logic for the table
        });
    });
});
</script>
        <script>
// Payment Modal Functions
function openPaymentModal(button) {
    const modal = document.querySelector('.payment-modal');
    const amountInput = modal.querySelector('input[readonly]');
    const amount = button.getAttribute('data-amount');
    
    amountInput.value = amount;
    modal.classList.add('active');
}

function closePaymentModal() {
    document.querySelector('.payment-modal').classList.remove('active');
}

// Payment Method Change Handler
document.getElementById('paymentMethod').addEventListener('change', function() {
    const checkFields = document.getElementById('checkFields');
    if (this.value === 'check') {
        checkFields.classList.add('active');
    } else {
        checkFields.classList.remove('active');
    }
});

// Close Modal on Outside Click
document.querySelector('.payment-modal').addEventListener('click', function(e) {
    if (e.target === this) {
        closePaymentModal();
    }
});

// Form Submit Handler
document.querySelector('.payment-form').addEventListener('submit', function(e) {
    e.preventDefault();
    // Handle payment submission
    closePaymentModal();
});
</script>
    <script>

// Attachments Tab JavaScript
document.addEventListener('DOMContentLoaded', function() {
    const modal = document.querySelector('.attachment-modal');
    const modalImage = modal.querySelector('.attachment-modal-image');
    const modalClose = modal.querySelector('.attachment-modal-close');
    const attachmentImages = document.querySelectorAll('.attachment-image');

    // Open Modal
    attachmentImages.forEach(img => {
        img.addEventListener('click', function() {
            modalImage.src = this.src;
            modal.classList.add('active');
        });
    });

    // Close Modal
    modalClose.addEventListener('click', function() {
        modal.classList.remove('active');
    });

    // Close Modal on Outside Click
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            modal.classList.remove('active');
        }
    });
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const teeth = document.querySelectorAll('.tooth');
    const selectedTeethInput = document.getElementById('selected-teeth');
    let selectedTeeth = [];

    teeth.forEach(tooth => {
        tooth.addEventListener('click', function() {
            const toothNumber = this.dataset.number;
            
            if (this.classList.contains('selected')) {
                this.classList.remove('selected');
                selectedTeeth = selectedTeeth.filter(num => num !== toothNumber);
            } else {
                this.classList.add('selected');
                selectedTeeth.push(toothNumber);
            }

            selectedTeethInput.value = selectedTeeth.join(', ');
        });
    });

    // Add more JavaScript functionality as needed
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // متغیرهای اصلی
    let selectedToothElement = null;
    let selectedIcon = null;
    
    // المان‌های DOM
    const teethCountInput = document.getElementById('selected-teeth');
    const modal = document.querySelector('.dental-icon-modal');
    const dentalTypeButtons = document.querySelectorAll('.dental-type-button');
    const descriptionInput = document.querySelector('.dental-description-select');
    const descriptionDropdown = document.querySelector('.dental-description-dropdown');
    const descriptionGroups = document.querySelectorAll('.dental-description-group');
    const generalFeeInput = document.getElementById('generalFee');
    const specialFeeInput = document.getElementById('specialFee');

    // تنظیم ساختار مودال
    initializeModal();
    initializeEventListeners();
    initializeTeethHandlers();
    initializeTreatmentHandlers();

    function initializeModal() {
        modal.innerHTML = `
            <div class="dental-modal-content">
                <div class="dental-modal-header">
                    <h3>انتخاب وضعیت دندان</h3>
                    <button class="dental-modal-close">&times;</button>
                </div>
                <div class="dental-modal-body">
                    <div class="dental-icon-grid">
                        ${getToothIconsHTML()}
                    </div>
                    <div class="dental-tooth-notes">
                        <label>یادداشت برای این دندان:</label>
                        <textarea class="dental-tooth-note"></textarea>
                    </div>
                    <div class="dental-modal-actions">
                        <button class="dental-modal-save">ذخیره</button>
                        <button class="dental-modal-cancel">بستن</button>
                    </div>
                </div>
            </div>
        `;
    }

    function getToothIconsHTML() {
        const icons = [
            { icon: 'tooth', text: 'دندان سالم', class: 'fa-tooth' },
            { icon: 'implant', text: 'ایمپلنت', class: 'fa-teeth' },
            { icon: 'missing', text: 'دندان از دست رفته', class: 'fa-times' },
            { icon: 'crown', text: 'روکش', class: 'fa-crown' },
            { icon: 'bridge', text: 'بریج', class: 'fa-grip-lines' },
            { icon: 'decay', text: 'پوسیدگی', class: 'fa-bug' },
            { icon: 'filling', text: 'پر شده', class: 'fa-fill' },
            { icon: 'root-canal', text: 'عصب کشی شده', class: 'fa-wave-square' },
            { icon: 'extraction', text: 'نیاز به کشیدن', class: 'fa-minus-circle' },
            { icon: 'done', text: 'درمان تکمیل', class: 'fa-check-circle' }
        ];

        return icons.map(icon => `
            <div class="dental-icon-option" data-icon="${icon.icon}">
                <i class="fas ${icon.class}"></i>
                <span>${icon.text}</span>
            </div>
        `).join('');
    }
    function initializeEventListeners() {
        // Modal event handlers
        const modalClose = modal.querySelector('.dental-modal-close');
        const modalSave = modal.querySelector('.dental-modal-save');
        const modalCancel = modal.querySelector('.dental-modal-cancel');
        const iconOptions = modal.querySelectorAll('.dental-icon-option');

        modalClose.addEventListener('click', closeToothModal);
        modalCancel.addEventListener('click', closeToothModal);
        modalSave.addEventListener('click', handleModalSave);

        // انتخاب آیکون در مودال
        iconOptions.forEach(option => {
            option.addEventListener('click', function() {
                iconOptions.forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                selectedIcon = this.dataset.icon;
            });
        });
    }

    function initializeTeethHandlers() {
        document.querySelectorAll('.dental-single-tooth').forEach(tooth => {
            // کلیک چپ برای انتخاب/حذف انتخاب دندان
            tooth.addEventListener('click', function(e) {
                toggleToothSelection(this);
                updateSelectedTeethCount();
            });

            // راست کلیک برای باز کردن مودال تغییر وضعیت
            tooth.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                selectedToothElement = this;
                openToothModal(this);
            });
        });

        // دکمه‌های انتخاب سریع
        document.querySelectorAll('.dental-select-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const selection = this.dataset.select;
                const isDeselecting = this.classList.contains('active');
                
                document.querySelectorAll('.dental-select-btn').forEach(b => 
                    b.classList.remove('active'));
                
                if (!isDeselecting) {
                    this.classList.add('active');
                    selectTeeth(selection);
                } else {
                    deselectTeeth(selection);
                }
            });
        });
    }

    function initializeTreatmentHandlers() {
        // کلیک روی دکمه‌های نوع درمان
        dentalTypeButtons.forEach(button => {
            button.addEventListener('click', () => {
                dentalTypeButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                const selectedType = button.getAttribute('data-type');
                handleTreatmentTypeSelection(selectedType);
            });
        });

        // مدیریت ورودی شرح درمان
        descriptionInput.addEventListener('focus', handleDescriptionFocus);
        descriptionInput.addEventListener('input', handleDescriptionSearch);

        // انتخاب آیتم شرح درمان
        document.querySelectorAll('.dental-description-item').forEach(item => {
            item.addEventListener('click', () => handleDescriptionSelection(item));
        });

        // بستن دراپ‌داون با کلیک بیرون
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.dental-description-wrapper')) {
                descriptionDropdown.classList.remove('active');
            }
        });
    }

    // توابع مدیریت مودال
    function handleModalSave() {
        if (selectedToothElement && selectedIcon) {
            updateToothIcon(selectedToothElement, selectedIcon);
            const note = modal.querySelector('.dental-tooth-note').value;
            selectedToothElement.setAttribute('data-note', note);
            
            // ذخیره وضعیت آیکون
            const iconContainer = selectedToothElement.querySelector('.dental-tooth-icon');
            iconContainer.setAttribute('data-icon', selectedIcon);
            iconContainer.className = `dental-tooth-icon tooth-state-${selectedIcon}`;
        }
        closeToothModal();
    }

    function openToothModal(tooth) {
        modal.classList.add('active');
        
        // بازیابی وضعیت قبلی آیکون
        const currentIcon = tooth.querySelector('.dental-tooth-icon').getAttribute('data-icon');
        if (currentIcon) {
            const iconOption = modal.querySelector(`.dental-icon-option[data-icon="${currentIcon}"]`);
            if (iconOption) {
                modal.querySelectorAll('.dental-icon-option').forEach(opt => 
                    opt.classList.remove('selected'));
                iconOption.classList.add('selected');
                selectedIcon = currentIcon;
            }
        }
        
        // بازیابی یادداشت قبلی
        const note = tooth.getAttribute('data-note') || '';
        modal.querySelector('.dental-tooth-note').value = note;
    }

    function closeToothModal() {
        modal.classList.remove('active');
        selectedToothElement = null;
        selectedIcon = null;
        modal.querySelectorAll('.dental-icon-option').forEach(opt => 
            opt.classList.remove('selected'));
        modal.querySelector('.dental-tooth-note').value = '';
    }
    // توابع مدیریت درمان
    function handleTreatmentTypeSelection(selectedType) {
        descriptionGroups.forEach(group => {
            group.style.display = 'none';
        });
        
        const selectedGroup = document.querySelector(
            `.dental-description-group[data-type="${selectedType}"]`);
        if (selectedGroup) {
            selectedGroup.style.display = 'block';
        }

        // پاک کردن مقادیر قبلی
        descriptionInput.value = '';
        generalFeeInput.value = '';
        specialFeeInput.value = '';
        
        descriptionDropdown.classList.add('active');
    }

    function handleDescriptionFocus() {
        const activeButton = document.querySelector('.dental-type-button.active');
        if (!activeButton) {
            alert('لطفاً ابتدا نوع درمان را انتخاب کنید');
            descriptionInput.blur();
            return;
        }
        descriptionDropdown.classList.add('active');
    }

    function handleDescriptionSearch(e) {
        const searchTerm = e.target.value.toLowerCase();
        const activeGroup = document.querySelector(
            '.dental-description-group[style*="block"]');
        
        if (activeGroup) {
            const items = activeGroup.querySelectorAll('.dental-description-item');
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(searchTerm) ? 'block' : 'none';
            });
        }
    }

    function handleDescriptionSelection(item) {
        descriptionInput.value = item.textContent;
        
        const generalFee = item.getAttribute('data-general');
        const specialFee = item.getAttribute('data-special');
        
        generalFeeInput.value = Number(generalFee).toLocaleString() + ' تومان';
        specialFeeInput.value = Number(specialFee).toLocaleString() + ' تومان';
        
        descriptionDropdown.classList.remove('active');
    }

    // توابع مدیریت دندان‌ها
    function toggleToothSelection(tooth) {
        tooth.classList.toggle('selected');
        updateSelectedTeethCount();
    }

    function updateToothIcon(tooth, iconType) {
        const iconElement = tooth.querySelector('i');
        const iconContainer = tooth.querySelector('.dental-tooth-icon');
        
        // حذف کلاس‌های قبلی
        iconElement.className = '';
        iconContainer.className = 'dental-tooth-icon';
        
        // اضافه کردن کلاس جدید
        const iconClass = getIconClass(iconType);
        iconElement.className = iconClass;
        iconContainer.classList.add(`tooth-state-${iconType}`);
    }

    function getIconClass(iconType) {
        const iconClasses = {
            'implant': 'fas fa-teeth',
            'missing': 'fas fa-times',
            'crown': 'fas fa-crown',
            'bridge': 'fas fa-grip-lines',
            'decay': 'fas fa-bug',
            'filling': 'fas fa-fill',
            'root-canal': 'fas fa-wave-square',
            'extraction': 'fas fa-minus-circle',
            'done': 'fas fa-check-circle',
            'tooth': 'fas fa-tooth'
        };
        return iconClasses[iconType] || 'fas fa-tooth';
    }

    function selectTeeth(selection) {
        const allTeeth = document.querySelectorAll('.dental-single-tooth');
        const upperTeeth = document.querySelectorAll('.dental-upper-row .dental-single-tooth');
        const lowerTeeth = document.querySelectorAll('.dental-lower-row .dental-single-tooth');
        
        switch(selection) {
            case 'all':
                allTeeth.forEach(tooth => {
                    tooth.classList.add('selected');
                });
                break;
            case 'upper':
                upperTeeth.forEach(tooth => {
                    tooth.classList.add('selected');
                });
                break;
            case 'lower':
                lowerTeeth.forEach(tooth => {
                    tooth.classList.add('selected');
                });
                break;
        }
        updateSelectedTeethCount();
    }

    function deselectTeeth(selection) {
        const allTeeth = document.querySelectorAll('.dental-single-tooth');
        const upperTeeth = document.querySelectorAll('.dental-upper-row .dental-single-tooth');
        const lowerTeeth = document.querySelectorAll('.dental-lower-row .dental-single-tooth');
        
        switch(selection) {
            case 'all':
                allTeeth.forEach(tooth => {
                    tooth.classList.remove('selected');
                });
                break;
            case 'upper':
                upperTeeth.forEach(tooth => {
                    tooth.classList.remove('selected');
                });
                break;
            case 'lower':
                lowerTeeth.forEach(tooth => {
                    tooth.classList.remove('selected');
                });
                break;
        }
        updateSelectedTeethCount();
    }

    function updateSelectedTeethCount() {
        const selectedTeeth = document.querySelectorAll('.dental-single-tooth.selected').length;
        teethCountInput.value = selectedTeeth;
    }
});
</script>
<script>
function printTreatmentPlan(singleRow = null) {
    // ایجاد یک div جدید برای محتوای پرینت
    const printWindow = window.open('', '_blank');
    
    // اضافه کردن محتوا به پنجره جدید
    printWindow.document.write(`
        <!DOCTYPE html>
        <html dir="rtl" lang="fa">
        <head>
            <meta charset="UTF-8">
            <title>طرح درمان</title>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
            <style>
                @font-face {
                    font-family: 'IRANSans';
                    src: url('path-to-your-font/IRANSans.ttf');
                }

                body {
                    font-family: 'IRANSans', Tahoma, Arial;
                    padding: 20px;
                    direction: rtl;
                }

                .print-page {
                    max-width: 210mm;
                    margin: 0 auto;
                    background: white;
                }

                .print-header {
                    display: flex;
                    align-items: center;
                    gap: 20px;
                    padding-bottom: 20px;
                    border-bottom: 2px solid #4CAF50;
                }

                .clinic-logo {
                    width: 100px;
                    text-align: center;
                }

                .clinic-logo i {
                    font-size: 60px;
                    color: #4CAF50;
                }

                .clinic-info {
                    flex: 1;
                }

                .clinic-info h1 {
                    color: #4CAF50;
                    margin: 0 0 10px 0;
                    font-size: 24px;
                }

                .clinic-details {
                    display: flex;
                    gap: 20px;
                    font-size: 14px;
                }

                .patient-info {
                    margin: 20px 0;
                    padding: 15px;
                    background: #f8f9fa;
                    border-radius: 8px;
                }

                .patient-header {
                    display: flex;
                    gap: 20px;
                    align-items: center;
                }

                .patient-avatar i {
                    font-size: 50px;
                    color: #4CAF50;
                }

                .treatment-table {
                    width: 100%;
                    border-collapse: collapse;
                    margin: 20px 0;
                }

                .treatment-table th,
                .treatment-table td {
                    border: 1px solid #ddd;
                    padding: 10px;
                    text-align: center;
                }

                .treatment-table th {
                    background: #f8f9fa;
                }

                .treatment-notes {
                    margin: 20px 0;
                    padding: 15px;
                    background: #f8f9fa;
                    border-radius: 8px;
                }

                .signatures {
                    display: flex;
                    justify-content: space-between;
                    margin-top: 50px;
                }

                .signature-box {
                    text-align: center;
                }

                .signature-line {
                    width: 200px;
                    height: 60px;
                    border: 1px solid #ddd;
                    margin-top: 10px;
                }

                .clinic-footer {
                    text-align: center;
                    margin-top: 30px;
                    padding-top: 20px;
                    border-top: 2px solid #4CAF50;
                }
            </style>
        </head>
        <body>
            <div class="print-page">
                <div class="print-header">
                    <div class="clinic-logo">
                        <i class="fas fa-tooth"></i>
                    </div>
                    <div class="clinic-info">
                        <h1>کلینیک تخصصی دندانپزشکی زیبادنت</h1>
                        <p>دارای مجوز رسمی از وزارت بهداشت</p>
                        <div class="clinic-details">
                            <p>تلفن: 021-12345678</p>
                            <p>آدرس: تهران، خیابان ولیعصر، کوچه مهر، پلاک 12</p>
                        </div>
                    </div>
                </div>

                <div class="patient-info">
                    <div class="patient-header">
                        <div class="patient-avatar">
                            <i class="fas fa-user-circle"></i>
                        </div>
                        <div class="patient-details">
                            <table>
                                <tr>
                                    <th>نام و نام خانوادگی:</th>
                                    <td>علی محمدی</td>
                                    <th>شماره پرونده:</th>
                                    <td>12345</td>
                                </tr>
                                <tr>
                                    <th>تاریخ تولد:</th>
                                    <td>1370/06/15</td>
                                    <th>کد ملی:</th>
                                    <td>0123456789</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="treatment-plan-content">
                    <table class="treatment-table">
                        <thead>
                            <tr>
                                <th>ردیف</th>
                                <th>شماره دندان</th>
                                <th>نوع درمان</th>
                                <th>شرح درمان</th>
                                <th>تعرفه عمومی (تومان)</th>
                                <th>تعرفه تخصصی (تومان)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${getTreatmentRows(singleRow)}
                        </tbody>
                        <tfoot>
                            ${calculateTotals()}
                        </tfoot>
                    </table>
                </div>

                <div class="treatment-notes">
                    <h3>توضیحات تکمیلی:</h3>
                    <p>1. مدت زمان تقریبی انجام کل درمان‌ها: 3 جلسه</p>
                    <p>2. اعتبار این طرح درمان: یک ماه از تاریخ صدور</p>
                    <p>3. هزینه‌های لابراتوار جداگانه محاسبه می‌گردد</p>
                </div>

                <div class="signatures">
                    <div class="signature-box">
                        <p>پزشک معالج: دکتر رضا احمدی</p>
                        <div class="signature-line"></div>
                    </div>
                    <div class="signature-box">
                        <p>تأیید بیمار</p>
                        <div class="signature-line"></div>
                    </div>
                </div>

                <div class="clinic-footer">
                    <p>www.zibadent.com | info@zibadent.com</p>
                </div>
            </div>
        </body>
        </html>
    `);

    // تابع دریافت ردیف‌های جدول
    function getTreatmentRows(singleRow) {
        if (singleRow) {
            return createPrintRow(singleRow, 1);
        } else {
            const rows = document.querySelectorAll('#treatment-plan-list tr');
            return Array.from(rows).map((row, index) => 
                createPrintRow(row, index + 1)).join('');
        }
    }

    // تابع ایجاد ردیف جدول
    function createPrintRow(row, index) {
        const cells = row.querySelectorAll('td');
        return `
            <tr>
                <td>${index}</td>
                <td>${cells[1].textContent}</td>
                <td>${cells[2].textContent}</td>
                <td>${cells[3].textContent}</td>
                <td>${cells[5].textContent}</td>
                <td>${cells[6].textContent}</td>
            </tr>
        `;
    }

    // تابع محاسبه جمع کل
    function calculateTotals() {
        let generalTotal = 0;
        let specialTotal = 0;
        const rows = document.querySelectorAll('#treatment-plan-list tr');
        
        rows.forEach(row => {
            const cells = row.querySelectorAll('td');
            generalTotal += parseInt(cells[5].textContent.replace(/[^\d]/g, '') || 0);
            specialTotal += parseInt(cells[6].textContent.replace(/[^\d]/g, '') || 0);
        });

        return `
            <tr>
                <th colspan="4">جمع کل:</th>
                <td>${generalTotal.toLocaleString()} تومان</td>
                <td>${specialTotal.toLocaleString()} تومان</td>
            </tr>
        `;
    }

    // بستن document و چاپ
    printWindow.document.close();
    printWindow.focus();
    
    // کمی تأخیر برای اطمینان از لود شدن فونت‌ها و استایل‌ها
    setTimeout(() => {
        printWindow.print();
        // printWindow.close();
    }, 1000);
}

function printSingleTreatmentPlan(row) {
    printTreatmentPlan(row);
}

</script>


<script>
let currentPaymentPrintType = null;
let selectedPaymentOptions = new Set();

function openPaymentPrintModal(type) {
    currentPaymentPrintType = type;
    document.querySelector('.payment-print-modal').style.display = 'flex';
    
    // تنظیم گزینه‌ها بر اساس نوع پرینت
    document.querySelectorAll('.payment-print-option').forEach(option => {
        if (type === 'thermal') {
            // فقط گزینه‌های مجاز در پرینت حرارتی
            if (['clinic-info', 'doctor-info', 'print-count'].includes(option.value)) {
                option.parentElement.style.display = 'flex';
                option.checked = true;
                selectedPaymentOptions.add(option.value);
            } else {
                option.parentElement.style.display = 'none';
                option.checked = false;
                selectedPaymentOptions.delete(option.value);
            }
        } else {
            // نمایش همه گزینه‌ها برای پرینت معمولی
            option.parentElement.style.display = 'flex';
            option.checked = true;
            selectedPaymentOptions.add(option.value);
        }
    });
}

function generatePaymentPrint() {
    selectedPaymentOptions.clear();
    document.querySelectorAll('.payment-print-option:checked').forEach(option => {
        selectedPaymentOptions.add(option.value);
    });

    const printWindow = window.open('', '_blank');
    
    const template = currentPaymentPrintType === 'thermal' ? 
        generatePaymentThermalTemplate() : generatePaymentNormalTemplate();

    printWindow.document.write(template);
    printWindow.document.close();
    
    setTimeout(() => {
        printWindow.print();
        // printWindow.close();
    }, 1000);

    closePaymentPrintModal();
}

function generatePaymentThermalTemplate() {
    return `
        <!DOCTYPE html>
        <html dir="rtl" lang="fa">
        <head>
            <meta charset="UTF-8">
            <title>رسید پرداخت</title>
            <style>
                @media print {
                    @page {
                        size: 80mm auto;
                        margin: 0;
                    }
                    
                    body {
                        width: 80mm;
                        padding: 5mm;
                        margin: 0;
                        font-family: 'IRANSans', Tahoma;
                        font-size: 12px;
                    }

                    .thermal-receipt {
                        text-align: center;
                    }

                    .receipt-header {
                        border-bottom: 1px dashed #000;
                        padding-bottom: 10px;
                        margin-bottom: 10px;
                    }

                    .receipt-body {
                        text-align: right;
                    }

                    .receipt-row {
                        display: flex;
                        justify-content: space-between;
                        margin: 5px 0;
                    }

                    .receipt-footer {
                        border-top: 1px dashed #000;
                        margin-top: 10px;
                        padding-top: 10px;
                        text-align: center;
                        font-size: 10px;
                    }
                }
            </style>
        </head>
        <body>
            <div class="thermal-receipt">
                ${selectedPaymentOptions.has('clinic-info') ? `
                    <div class="receipt-header">
                        <h2>کلینیک دندانپزشکی زیبادنت</h2>
                        <p>تلفن: 021-12345678</p>
                    </div>
                ` : ''}

                <div class="receipt-body">
                    <div class="receipt-row">
                        <span>شماره رسید:</span>
                        <span>12345</span>
                    </div>
                    <div class="receipt-row">
                        <span>تاریخ:</span>
                        <span>${new Date().toLocaleDateString('fa-IR')}</span>
                    </div>
                    ${selectedPaymentOptions.has('doctor-info') ? `
                        <div class="receipt-row">
                            <span>پزشک معالج:</span>
                            <span>دکتر محمدی</span>
                        </div>
                    ` : ''}
                    <div class="receipt-row">
                        <span>مبلغ:</span>
                        <span>${document.querySelector('.payment-amount').textContent}</span>
                    </div>
                </div>

                ${selectedPaymentOptions.has('print-count') ? `
                    <div class="receipt-footer">
                        <p>نسخه: 1/1</p>
                    </div>
                ` : ''}
            </div>
        </body>
        </html>
    `;
}

function generatePaymentNormalTemplate() {
    return `
        <!DOCTYPE html>
        <html dir="rtl" lang="fa">
        <head>
            <meta charset="UTF-8">
            <title>رسید پرداخت</title>
            <style>
                @page {
                    size: A4;
                    margin: 1cm;
                }

                body {
                    font-family: 'IRANSans', Tahoma;
                    padding: 20px;
                }

                .receipt {
                    max-width: 210mm;
                    margin: 0 auto;
                    padding: 20px;
                    border: 1px solid #ddd;
                }

                .receipt-header {
                    display: flex;
                    justify-content: space-between;
                    border-bottom: 2px solid #4CAF50;
                    padding-bottom: 20px;
                    margin-bottom: 20px;
                }

                .receipt-body {
                    margin: 20px 0;
                }

                .payment-details {
                    width: 100%;
                    border-collapse: collapse;
                    margin: 20px 0;
                }

                .payment-details th,
                .payment-details td {
                    border: 1px solid #ddd;
                    padding: 10px;
                    text-align: right;
                }

                .payment-details th {
                    background: #f8f9fa;
                }

                .signatures {
                    display: flex;
                    justify-content: space-between;
                    margin-top: 50px;
                }

                .signature-box {
                    text-align: center;
                }

                .signature-line {
                    width: 200px;
                    height: 60px;
                    border: 1px solid #ddd;
                    margin-top: 10px;
                }
            </style>
        </head>
        <body>
            <div class="receipt">
                ${selectedPaymentOptions.has('clinic-info') ? `
                    <div class="receipt-header">
                        <div>
                            <h1>کلینیک دندانپزشکی زیبادنت</h1>
                            <p>تلفن: 021-12345678</p>
                            <p>آدرس: تهران، خیابان ولیعصر</p>
                        </div>
                        <div>
                            <p>شماره رسید: 12345</p>
                            <p>تاریخ: ${new Date().toLocaleDateString('fa-IR')}</p>
                        </div>
                    </div>
                ` : ''}

                ${selectedPaymentOptions.has('patient-info') ? `
                    <div class="patient-info">
                        <h3>اطلاعات بیمار</h3>
                        <p>نام و نام خانوادگی: علی محمدی</p>
                        <p>شماره پرونده: 12345</p>
                    </div>
                ` : ''}

                ${selectedPaymentOptions.has('payment-details') ? `
                    <div class="receipt-body">
                        <table class="payment-details">
                            <tr>
                                <th>شرح</th>
                                <th>مبلغ (تومان)</th>
                            </tr>
                            <tr>
                                <td>درمان ترمیمی</td>
                                <td>2,500,000</td>
                            </tr>
                            <tr>
                                <td>پرداختی</td>
                                <td>1,000,000</td>
                            </tr>
                            <tr>
                                <td>مانده</td>
                                <td>1,500,000</td>
                            </tr>
                        </table>
                    </div>
                ` : ''}

                ${selectedPaymentOptions.has('signatures') ? `
                    <div class="signatures">
                        <div class="signature-box">
                            <p>امضاء پرداخت کننده</p>
                            <div class="signature-line"></div>
                        </div>
                        <div class="signature-box">
                            <p>امضاء دریافت کننده</p>
                            <div class="signature-line"></div>
                        </div>
                    </div>
                ` : ''}
            </div>
        </body>
        </html>
    `;
}
// اضافه کردن Event Listener برای بستن پنجره پرینت
function addPrintWindowHandlers(printWindow) {
    // بستن با کلیک بیرون
    printWindow.addEventListener('click', function(e) {
        if (e.target === printWindow.document.body) {
            printWindow.close();
        }
    });

    // بستن با کلید ESC
    printWindow.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            printWindow.close();
        }
    });

    // بستن خودکار بعد از پرینت
    printWindow.onafterprint = function() {
        printWindow.close();
    };
}

// اضافه کردن این خط در تابع generatePrint یا generatePaymentPrint
function generatePaymentPrint() {
    // ... کد قبلی ...

    const printWindow = window.open('', '_blank');
    const template = currentPaymentPrintType === 'thermal' ? 
        generatePaymentThermalTemplate() : generatePaymentNormalTemplate();

    printWindow.document.write(template);
    printWindow.document.close();
    
    // اضافه کردن event handlers
    addPrintWindowHandlers(printWindow);
    
    setTimeout(() => {
        printWindow.print();
    }, 1000);

    closePaymentPrintModal();
}

</script>
<script>
let currentPaymentPrintType = null;
let selectedPaymentOptions = new Set();

function openPaymentPrintModal(type) {
    currentPaymentPrintType = type;
    document.querySelector('.payment-print-modal').style.display = 'flex';
    
    // تنظیم گزینه‌ها بر اساس نوع پرینت
    document.querySelectorAll('.payment-print-option').forEach(option => {
        if (type === 'thermal') {
            // فقط گزینه‌های مجاز در پرینت حرارتی
            if (['clinic-info', 'doctor-info', 'print-count'].includes(option.value)) {
                option.parentElement.style.display = 'flex';
                option.checked = true;
                selectedPaymentOptions.add(option.value);
            } else {
                option.parentElement.style.display = 'none';
                option.checked = false;
                selectedPaymentOptions.delete(option.value);
            }
        } else {
            // نمایش همه گزینه‌ها برای پرینت معمولی
            option.parentElement.style.display = 'flex';
            option.checked = true;
            selectedPaymentOptions.add(option.value);
        }
    });
}

function closePaymentPrintModal() {
    document.querySelector('.payment-print-modal').style.display = 'none';
    selectedPaymentOptions.clear();
    currentPaymentPrintType = null;
}

// اضافه کردن Event Listener برای بستن پنجره پرینت
function addPrintWindowHandlers(printWindow) {
    // بستن با کلیک بیرون
    printWindow.addEventListener('click', function(e) {
        if (e.target === printWindow.document.body) {
            printWindow.close();
        }
    });

    // بستن با کلید ESC
    printWindow.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            printWindow.close();
        }
    });

    // بستن خودکار بعد از پرینت
    printWindow.onafterprint = function() {
        printWindow.close();
    };
}

function generatePaymentPrint() {
    // جمع‌آوری گزینه‌های انتخاب شده
    selectedPaymentOptions.clear();
    document.querySelectorAll('.payment-print-option:checked').forEach(option => {
        selectedPaymentOptions.add(option.value);
    });

    const printWindow = window.open('', '_blank');
    
    // انتخاب قالب مناسب بر اساس نوع پرینت
    const template = currentPaymentPrintType === 'thermal' ? 
        generatePaymentThermalTemplate() : generatePaymentNormalTemplate();

    printWindow.document.write(template);
    printWindow.document.close();
    
    // اضافه کردن event handlers
    addPrintWindowHandlers(printWindow);
    
    setTimeout(() => {
        printWindow.print();
    }, 1000);

    closePaymentPrintModal();
}

// اضافه کردن این تابع به هر دو اسکریپت
// این تابع رو در ابتدای فایل JavaScript اضافه کنید
document.addEventListener('DOMContentLoaded', function() {
    // دکمه‌های بستن مودال
    const closeButtons = document.querySelectorAll('.payment-modal-close, .payment-print-btn-cancel');
    closeButtons.forEach(button => {
        button.addEventListener('click', function() {
            const modal = document.querySelector('.payment-print-modal');
            if (modal) {
                modal.style.display = 'none';
            }
        });
    });

    // بستن با کلیک خارج از مودال
    const modal = document.querySelector('.payment-print-modal');
    if (modal) {
        modal.addEventListener('click', function(event) {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        });
    }

    // بستن با کلید ESC
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            const modal = document.querySelector('.payment-print-modal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
    });

    // دکمه پرینت
    const printButton = document.querySelector('.payment-print-btn-print');
    if (printButton) {
        printButton.addEventListener('click', generatePaymentPrint);
    }
});

</script>
<script>
    // بازشدن فیلد اقساط
    function toggleInstallmentFields() {
    const paymentType = document.getElementById('paymentType').value;
    const installmentFields = document.getElementById('installmentFields');
    
    if (paymentType === 'installment') {
        installmentFields.style.display = 'block';
        // اضافه کردن کلاس برای انیمیشن
        installmentFields.classList.add('fade-in');
    } else {
        installmentFields.style.display = 'none';
        installmentFields.classList.remove('fade-in');
    }
}
</script>
<script>
    // تنظیمات ستون‌ها
const columnSettings = {
    columns: [
        { id: 'row', title: 'ردیف', visible: true },
        { id: 'date', title: 'تاریخ', visible: true },
        { id: 'teeth', title: 'شماره دندان', visible: true },
        { id: 'treatment-type', title: 'نوع درمان', visible: true },
        { id: 'description', title: 'شرح درمان', visible: true },
        { id: 'doctor', title: 'پزشک معالج', visible: true },
        { id: 'assistant', title: 'دستیار', visible: true },
        { id: 'general-fee', title: 'تعرفه عمومی', visible: true },
        { id: 'special-fee', title: 'تعرفه تخصصی', visible: true },
        { id: 'discount', title: 'تخفیف', visible: true },
        { id: 'material-cost', title: 'هزینه مواد', visible: true },
        { id: 'lab-cost', title: 'هزینه لابراتور', visible: true },
        { id: 'total', title: 'مبلغ قابل پرداخت', visible: true },
        { id: 'insurance', title: 'وضعیت بیمه', visible: true },
        { id: 'status', title: 'وضعیت درمان', visible: true },
        { id: 'next-visit', title: 'تاریخ مراجعه بعدی', visible: true },
        { id: 'actions', title: 'عملیات', visible: true }
    ]
};

function openColumnSettings() {
    const modal = document.getElementById('columnSettingsModal');
    const columnsList = modal.querySelector('.columns-list');
    
    // ساخت چک‌باکس‌ها
    columnsList.innerHTML = columnSettings.columns.map(column => `
        <label class="column-checkbox">
            <input type="checkbox" 
                   data-column="${column.id}" 
                   ${column.visible ? 'checked' : ''}>
            ${column.title}
        </label>
    `).join('');
    
    modal.style.display = 'flex';
}

function closeColumnSettings() {
    document.getElementById('columnSettingsModal').style.display = 'none';
}

function saveColumnSettings() {
    const checkboxes = document.querySelectorAll('.column-checkbox input');
    checkboxes.forEach(checkbox => {
        const columnId = checkbox.dataset.column;
        const column = columnSettings.columns.find(col => col.id === columnId);
        if (column) {
            column.visible = checkbox.checked;
        }
    });
    
    updateTableColumns();
    closeColumnSettings();
}

function updateTableColumns() {
    const table = document.querySelector('.treatment-table');
    const headers = table.querySelectorAll('th');
    const rows = table.querySelectorAll('tbody tr');
    
    columnSettings.columns.forEach((column, index) => {
        if (headers[index]) {
            headers[index].style.display = column.visible ? '' : 'none';
        }
        rows.forEach(row => {
            const cell = row.cells[index];
            if (cell) {
                cell.style.display = column.visible ? '' : 'none';
            }
        });
    });
}

// اضافه کردن عملکرد به دکمه‌های عملیات
function editTreatment(id) {
    // منطق ویرایش
    console.log('Editing treatment:', id);
}

function deleteTreatment(id) {
    // منطق حذف
    if (confirm('آیا از حذف این درمان اطمینان دارید؟')) {
        console.log('Deleting treatment:', id);
    }
}

function printTreatment(id) {
    // منطق پرینت
    console.log('Printing treatment:', id);
}

function createInvoice(id) {
    // منطق صدور فاکتور
    console.log('Creating invoice for treatment:', id);
}

</script>
<script>
    //tabe bime o moshakhasat
document.addEventListener('DOMContentLoaded', function() {
    // مدیریت تب‌های اصلی
    const mainNavTabs = document.querySelectorAll('.main-nav .nav-tab');
    const mainTabContents = document.querySelectorAll('.content-area .tab-content');

    // فعال کردن تب اول و محتوای آن به صورت پیش‌فرض
    const firstMainTab = mainNavTabs[0];
    const firstMainContent = mainTabContents[0];
    firstMainTab.classList.add('active');
    firstMainContent.classList.add('active');

    // مدیریت زیرتب‌ها
    const patientSubTabs = document.querySelectorAll('.sub-nav-tabs .sub-nav-tab:not(.print-button)');
    const patientSubContents = document.querySelectorAll('.sub-tab-content');

    // فعال کردن اولین زیرتب و محتوای آن به صورت پیش‌فرض
    const firstSubTab = patientSubTabs[0];
    const firstSubContent = patientSubContents[0];
    firstSubTab.classList.add('active');
    firstSubContent.classList.add('active');

    // رویداد کلیک برای تب‌های اصلی
    mainNavTabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const targetId = tab.getAttribute('data-tab');
            
            mainNavTabs.forEach(t => t.classList.remove('active'));
            mainTabContents.forEach(c => c.classList.remove('active'));
            
            tab.classList.add('active');
            document.querySelector(`#${targetId}`).classList.add('active');
        });
    });

    // رویداد کلیک برای زیرتب‌ها
    patientSubTabs.forEach(subTab => {
        subTab.addEventListener('click', () => {
            const targetId = subTab.getAttribute('data-sub-tab');
            
            patientSubTabs.forEach(t => t.classList.remove('active'));
            patientSubContents.forEach(c => c.classList.remove('active'));
            
            subTab.classList.add('active');
            document.querySelector(`#${targetId}`).classList.add('active');
        });
    });
});


</script>
<script>
    // virayesh - takmil etelaate bime - print
    document.addEventListener('DOMContentLoaded', function() {
    // تعریف لیست بیمه‌ها بر اساس نوع
    const insuranceProviders = {
        percentage: [
            { id: 'dana', name: 'بیمه دانا' },
            { id: 'iran', name: 'بیمه ایران' },
            { id: 'asia', name: 'بیمه آسیا' }
            // سایر بیمه‌های درصدی
        ],
        tariff: [
            { id: 'tamin', name: 'تأمین اجتماعی' },
            { id: 'salamat', name: 'بیمه سلامت' }
            // سایر بیمه‌های تعرفه‌ای
        ],
        total: [
            { id: 'mosalah', name: 'نیروهای مسلح' }
            // سایر بیمه‌های کلی
        ]
    };

    const insuranceTypeSelect = document.getElementById('insuranceType');
    const insuranceProviderSelect = document.getElementById('insuranceProvider');

    // مدیریت تغییر نوع بیمه
    insuranceTypeSelect.addEventListener('change', function() {
        // پاک کردن لیست قبلی
        insuranceProviderSelect.innerHTML = '<option value="">انتخاب کنید</option>';
        
        const selectedType = this.value;
        
        if (!selectedType) {
            insuranceProviderSelect.disabled = true;
            return;
        }

        // اضافه کردن گزینه‌های مربوط به نوع بیمه انتخاب شده
        const providers = insuranceProviders[selectedType] || [];
        providers.forEach(provider => {
            const option = document.createElement('option');
            option.value = provider.id;
            option.textContent = provider.name;
            insuranceProviderSelect.appendChild(option);
        });

        // فعال کردن select نام بیمه‌گر
        insuranceProviderSelect.disabled = false;
    });

    // اضافه کردن کلاس‌های CSS برای نمایش وضعیت غیرفعال
    insuranceProviderSelect.classList.add('disabled-select');
    
    // آپدیت کلاس‌ها بر اساس وضعیت فعال/غیرفعال
    insuranceProviderSelect.addEventListener('change', function() {
        this.classList.toggle('has-value', this.value !== '');
    });
});

 document.addEventListener('DOMContentLoaded', function() {
    // تنظیمات date picker برای فیلدهای تاریخ
    const dateInputs = document.querySelectorAll('.date-input');
    dateInputs.forEach(input => {
        // اینجا می‌توانید از کتابخانه‌های تاریخ شمسی مثل persian-datepicker استفاده کنید
        $(input).persianDatepicker({
            format: 'YYYY/MM/DD',
            autoClose: true,
            initialValue: true,
            observer: true,
            calendar: {
                persian: {
                    locale: 'fa'
                }
            }
        });
    });

    // مدیریت فرم
    const editProfileForm = document.querySelector('.edit-profile-form');
    if (editProfileForm) {
        editProfileForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // اعتبارسنجی فرم
            if (!validateForm(this)) {
                return;
            }

            // جمع‌آوری داده‌های فرم
            const formData = new FormData(this);
            
            // ارسال داده‌ها به سرور
            saveProfileData(formData);
        });
    }
});

function validateForm(form) {
    // اعتبارسنجی کد ملی
    const nationalIdInput = form.querySelector('input[pattern="[0-9]{10}"]');
    if (nationalIdInput && !validateNationalId(nationalIdInput.value)) {
        alert('کد ملی وارد شده معتبر نیست');
        return false;
    }

    // اعتبارسنجی شماره موبایل
    const phoneInputs = form.querySelectorAll('input[pattern="09[0-9]{9}"]');
    for (let input of phoneInputs) {
        if (input.value && !validateMobileNumber(input.value)) {
            alert('شماره موبایل وارد شده معتبر نیست');
            return false;
        }
    }

    return true;
}

function validateNationalId(code) {
    // پیاده‌سازی اعتبارسنجی کد ملی
    if (!/^\d{10}$/.test(code)) return false;
    
    const check = +code[9];
    const sum = code.split('').slice(0, 9)
        .reduce((acc, x, i) => acc + (+x * (10 - i)), 0) % 11;
    
    return sum < 2 ? check === sum : check === 11 - sum;
}

function validateMobileNumber(number) {
    return /^09[0-9]{9}$/.test(number);
}

async function saveProfileData(formData) {
    try {
        // ارسال داده‌ها به سرور
        const response = await fetch('/api/profile/update', {
            method: 'POST',
            body: formData
        });

        if (response.ok) {
            alert('اطلاعات با موفقیت ذخیره شد');
            // بروزرسانی نمایش اطلاعات در تب اطلاعات بیمار
            updatePatientInfoTab(formData);
        } else {
            throw new Error('خطا در ذخیره اطلاعات');
        }
    } catch (error) {
        alert('خطا در ذخیره اطلاعات: ' + error.message);
    }
}

</script>



<script>
document.addEventListener('DOMContentLoaded', function() {
    // مقداردهی اولیه داده‌ها
    loadPatientData();
    
    // تنظیم دراپ‌دان ذخیره
    setupDropdown();
    
    // تنظیم دکمه‌های پرینت
    setupPrintButtons();
    // مدیریت دکمه‌های خروجی

});

function loadPatientData() {
    // در حالت واقعی، این داده‌ها از سرور دریافت می‌شوند
    const patientData = {
        fileNumber: '12345',
        fullName: 'علی محمدی',
        nationalId: '0123456789',
        fatherName: 'محمد',
        birthDate: '1370/01/01',
        phone: '09123456789',
        emergency: '09187654321',
        address: 'تهران، خیابان ...',
        insurance: [
            {
                type: 'درصدی',
                provider: 'تأمین اجتماعی',
                number: '123456',
                validDate: '1402/12/29',
                coverage: '70%',
                status: 'فعال'
            }
        ],
        treatments: [
            {
                date: '1402/08/15',
                doctor: 'دکتر محمدی',
                description: 'عصب کشی دندان'
            }
        ]
    };

    // پر کردن اطلاعات در صفحه پرینت
    fillPatientInfo(patientData);
    fillInsuranceTable(patientData.insurance);
    fillTreatmentTable(patientData.treatments);
    updatePrintDate();
}

function fillPatientInfo(data) {
    document.getElementById('print-file-number').textContent = data.fileNumber;
    document.getElementById('print-fullname').textContent = data.fullName;
    document.getElementById('print-national-id').textContent = data.nationalId;
    document.getElementById('print-father-name').textContent = data.fatherName;
    document.getElementById('print-birth-date').textContent = data.birthDate;
    document.getElementById('print-phone').textContent = data.phone;
    document.getElementById('print-emergency').textContent = data.emergency;
    document.getElementById('print-address').textContent = data.address;
}

function fillInsuranceTable(insuranceData) {
    const tbody = document.querySelector('#print-insurance-table tbody');
    tbody.innerHTML = '';
    
    insuranceData.forEach(insurance => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${insurance.type}</td>
            <td>${insurance.provider}</td>
            <td>${insurance.number}</td>
            <td>${insurance.validDate}</td>
            <td>${insurance.coverage}</td>
            <td>${insurance.status}</td>
        `;
        tbody.appendChild(row);
    });
}

function fillTreatmentTable(treatmentData) {
    const tbody = document.querySelector('#print-treatment-table tbody');
    tbody.innerHTML = '';
    
    treatmentData.forEach(treatment => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${treatment.date}</td>
            <td>${treatment.doctor}</td>
            <td>${treatment.description}</td>
        `;
        tbody.appendChild(row);
    });
}

function updatePrintDate() {
    const today = new Date();
    const date = `${today.getFullYear()}/${today.getMonth() + 1}/${today.getDate()}`;
    document.getElementById('print-date').textContent = date;
}

function setupPrintButtons() {
    // پرینت مستقیم
    document.querySelector('[onclick="directPrint()"]').addEventListener('click', function() {
        window.print();
    });

    // پیش‌نمایش پرینت
    document.querySelector('[onclick="previewPrint()"]').addEventListener('click', function() {
        const preview = document.querySelector('.med-print-preview');
        preview.style.display = preview.style.display === 'none' ? 'block' : 'none';
    });

    // خروجی Excel
    document.querySelector('[onclick="exportToExcel()"]').addEventListener('click', function() {
        const data = gatherDataForExcel();
        const ws = XLSX.utils.json_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Patient Data");
        XLSX.writeFile(wb, "patient_record.xlsx");
    });

    // خروجی PDF
    document.querySelector('[onclick="exportToPDF()"]').addEventListener('click', function() {
        const element = document.querySelector('.med-print-page');
        html2pdf()
            .set({
                margin: 1,
                filename: 'patient_record.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
            })
            .from(element)
            .save();
    });

    // خروجی Word
    document.querySelector('[onclick="exportToWord()"]').addEventListener('click', function() {
        const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML to Word Document with JavaScript</title></head><body>";
        const footer = "</body></html>";
        const content = document.querySelector('.med-print-page').innerHTML;
        
        const sourceHTML = header + content + footer;
        const source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
        const fileDownload = document.createElement("a");
        
        document.body.appendChild(fileDownload);
        fileDownload.href = source;
        fileDownload.download = 'patient_record.doc';
        fileDownload.click();
        document.body.removeChild(fileDownload);
    });
}

function gatherDataForExcel() {
    // جمع‌آوری داده‌ها برای خروجی اکسل
    const patientInfo = {
        'شماره پرونده': document.getElementById('print-file-number').textContent,
        'نام و نام خانوادگی': document.getElementById('print-fullname').textContent,
        'کد ملی': document.getElementById('print-national-id').textContent,
        // ... سایر اطلاعات
    };
    
    return [patientInfo];
}

function setupDropdown() {
    const dropdownToggle = document.querySelector('.med-print-dropdown-toggle');
    const dropdownMenu = document.querySelector('.med-print-dropdown-menu');

    dropdownToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        dropdownMenu.style.display = dropdownMenu.style.display === 'block' ? 'none' : 'block';
    });

    // بستن دراپ‌داون با کلیک بیرون
    document.addEventListener('click', function() {
        dropdownMenu.style.display = 'none';
    });
}


function togglePreview() {
    const preview = document.querySelector('.med-print-preview');
    preview.style.display = preview.style.display === 'none' ? 'block' : 'none';
}

function exportToExcel() {
    // تبدیل داده‌های بیمار به فرمت مناسب برای Excel
    const data = [
        {
            'شماره پرونده': document.getElementById('print-file-number').textContent,
            'نام و نام خانوادگی': document.getElementById('print-fullname').textContent,
            'کد ملی': document.getElementById('print-national-id').textContent,
            'نام پدر': document.getElementById('print-father-name').textContent,
            'تاریخ تولد': document.getElementById('print-birth-date').textContent,
            'شماره تماس': document.getElementById('print-phone').textContent,
            'شماره اضطراری': document.getElementById('print-emergency').textContent,
            'آدرس': document.getElementById('print-address').textContent
        }
    ];

    // ایجاد workbook و worksheet
    const ws = XLSX.utils.json_to_sheet(data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "اطلاعات بیمار");

    // ذخیره فایل
    XLSX.writeFile(wb, "patient_record.xlsx");
}

function exportToWord() {
    // ایجاد محتوا برای Word
    const header = `
        <html xmlns:o='urn:schemas-microsoft-com:office:office' 
              xmlns:w='urn:schemas-microsoft-com:office:word' 
              xmlns='http://www.w3.org/TR/REC-html40'>
        <head>
            <meta charset='utf-8'>
            <title>پرونده بیمار</title>
        </head>
        <body>
    `;
    
    const footer = "</body></html>";
    const content = document.querySelector('.med-print-page').innerHTML;
    
    const sourceHTML = header + content + footer;
    const source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
    
    // ایجاد لینک دانلود
    const fileDownload = document.createElement("a");
    document.body.appendChild(fileDownload);
    fileDownload.href = source;
    fileDownload.download = 'patient_record.doc';
    fileDownload.click();
    document.body.removeChild(fileDownload);
}

function exportToPDF() {
    const element = document.querySelector('.med-print-page');
    
    const opt = {
        margin: 1,
        filename: 'patient_record.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { 
            scale: 2,
            useCORS: true,
            logging: true
        },
        jsPDF: { 
            unit: 'in', 
            format: 'a4', 
            orientation: 'portrait'
        }
    };

    // تبدیل به PDF و دانلود
    html2pdf().set(opt).from(element).save();
}

function loadPatientData() {
    // تنظیم تاریخ چاپ
    const today = new Date();
    const date = `${today.getFullYear()}/${today.getMonth() + 1}/${today.getDate()}`;
    document.getElementById('print-date').textContent = date;

    // اضافه کردن شماره صفحه
    document.querySelectorAll('.page-num').forEach((element, index) => {
        element.textContent = `${index + 1}`;
    });

    // اضافه کردن داده‌های نمونه به جداول
    addSampleDataToTables();
}

function addSampleDataToTables() {
    // داده‌های نمونه بیمه
    const insuranceData = [
        {
            type: 'درصدی',
            provider: 'تأمین اجتماعی',
            number: '123456',
            date: '1402/12/29',
            coverage: '70%',
            status: 'فعال'
        }
    ];

    // داده‌های نمونه درمان
    const treatmentData = [
        {
            date: '1402/08/15',
            doctor: 'دکتر محمدی',
            description: 'عصب کشی دندان'
        }
    ];

    // پر کردن جدول بیمه
    const insuranceTable = document.querySelector('#print-insurance-table tbody');
    insuranceData.forEach(item => {
        const row = insuranceTable.insertRow();
        row.innerHTML = `
            <td>${item.type}</td>
            <td>${item.provider}</td>
            <td>${item.number}</td>
            <td>${item.date}</td>
            <td>${item.coverage}</td>
            <td>${item.status}</td>
        `;
    });

    // پر کردن جدول درمان
    const treatmentTable = document.querySelector('#print-treatment-table tbody');
    treatmentData.forEach(item => {
        const row = treatmentTable.insertRow();
        row.innerHTML = `
            <td>${item.date}</td>
            <td>${item.doctor}</td>
            <td>${item.description}</td>
        `;
    });
}

</script>
  <script>
function openPrintPreview_pation_file() {
    // ذخیره داده‌ها در localStorage
    const printData = {
        insuranceData: document.querySelector('#print-insurance-table tbody')?.innerHTML,
        treatmentData: document.querySelector('#print-treatment-table tbody')?.innerHTML,
        // سایر داده‌های مورد نیاز
    };
    localStorage.setItem('printData', JSON.stringify(printData));

    // باز کردن صفحه جدید
    const printWindow = window.open('print_pation_file.html', 'print_pation_file', 
        'width=1000,height=800,menubar=no,toolbar=no,location=no,status=no');
}

    </script>
   
<script>
    // مدیریت کلیک خارج از مودال
window.onclick = function(event) {
    if (event.target.classList.contains('modal')) {
        closeInvoiceModal();
    }
}

// بستن مودال
function closeInvoiceModal() {
    document.getElementById('invoice-modal').style.display = 'none';
}

// نمایش مودال فاکتور
function showInvoiceModal() {
    const modal = document.getElementById('invoice-modal');
    modal.style.display = 'block';
    
    // پر کردن اطلاعات فاکتور
    document.getElementById('invoice-number').textContent = generateInvoiceNumber();
    document.getElementById('invoice-date').textContent = getCurrentDate();
    // سایر اطلاعات را هم پر کنید
}

// پرینت صورتحساب ساده
function printBill() {
    const printContent = `
        <div class="bill">
            <h2>صورتحساب</h2>
            <p>تاریخ: ${getCurrentDate()}</p>
            <p>شماره دندان: ${document.getElementById('selected-teeth').value}</p>
            <p>نام دندان: ${document.getElementById('teeth-names').value}</p>
            <table>
                <tr>
                    <th>مبلغ کل</th>
                    <th>پرداخت شده</th>
                    <th>مانده</th>
                </tr>
                <tr>
                    <td>2,500,000</td>
                    <td>1,500,000</td>
                    <td>1,000,000</td>
                </tr>
            </table>
        </div>
    `;
    
    const printWindow = window.open('', '', 'height=600,width=800');
    printWindow.document.write('<html><head><title>صورتحساب</title>');
    printWindow.document.write('<style>');
    printWindow.document.write(`
        .bill { font-family: Arial; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    `);
    printWindow.document.write('</style></head><body>');
    printWindow.document.write(printContent);
    printWindow.document.write('</body></html>');
    printWindow.document.close();
    printWindow.print();
}
function showInvoiceModal() {
    const modal = document.getElementById('invoice-modal');
    modal.style.display = 'block';
    
    // پر کردن اطلاعات فاکتور
    document.getElementById('invoice-number').textContent = generateInvoiceNumber();
    document.getElementById('total-number').textContent = generateTotalNumber();
    document.getElementById('invoice-date').textContent = getCurrentDate();
    
    // محاسبه مبالغ
    updateAmounts();
}

function generateInvoiceNumber() {
    return 'F-' + Math.floor(Math.random() * 10000);
}

function generateTotalNumber() {
    return 'T-' + Math.floor(Math.random() * 100000);
}

function updateAmounts() {
    const debitAmount = 2500000;
    const creditAmount = 1500000;
    const remainingAmount = debitAmount - creditAmount;

    document.getElementById('debit-amount').textContent = formatNumber(debitAmount);
    document.getElementById('credit-amount').textContent = formatNumber(creditAmount);
    document.getElementById('remaining-amount').textContent = formatNumber(remainingAmount);
}

function formatNumber(number) {
    return new Intl.NumberFormat('fa-IR').format(number);
}
// پرینت فاکتور رسمی
function printInvoice() {
    const printContent = document.getElementById('printable-invoice').innerHTML;
    const printWindow = window.open('', '', 'height=600,width=800');
    printWindow.document.write('<html><head><title>فاکتور رسمی</title>');
    printWindow.document.write('<style>');
    printWindow.document.write(`
        @media print {
            body { direction: rtl; }
            .invoice-table { width: 100%; border-collapse: collapse; }
            .invoice-table th, .invoice-table td { border: 1px solid #000; padding: 8px; text-align: center; }
            .debit-row { background-color: #fff; }
            .credit-row { background-color: #f9f9f9; }
            .remaining-row { background-color: #f0f0f0; font-weight: bold; }
            .signature-box { margin-top: 50px; text-align: center; }
            .signature-line { width: 200px; height: 1px; background-color: #000; margin: 50px auto 0; }
        }
    `);
    printWindow.document.write('</style></head><body>');
    printWindow.document.write(printContent);
    printWindow.document.write('</body></html>');
    printWindow.document.close();
    printWindow.print();
}
</script>
<script>
    // تعریف متغیرهای اصلی
const selectedTeeth = new Set();
const jawNames = {
    upper: "فک بالا (Maxilla)",
    lower: "فک پایین (Mandible)",
    all: "کل فک‌ها (Full Mouth)"
};

// اضافه کردن event listener برای کلیک روی دندان‌ها
function initializeToothSelection() {
    document.querySelectorAll('.tooth-lab').forEach(tooth => {
        tooth.addEventListener('click', function(event) {
            event.stopPropagation(); // جلوگیری از تداخل با سایر event ها
            const toothNumber = this.dataset.toothNumber;
            toggleToothSelection(this, toothNumber);
            updateSelectedTeeth();
        });
    });
}

// تابع toggle برای انتخاب/حذف انتخاب دندان
function toggleToothSelection(tooth, toothNumber) {
    if (tooth.classList.contains('selected')) {
        tooth.classList.remove('selected');
        selectedTeeth.delete(toothNumber);
    } else {
        tooth.classList.add('selected');
        selectedTeeth.add(toothNumber);
    }
}

// انتخاب تمام دندان‌ها
function selectAllTeeth() {
    const allTeeth = document.querySelectorAll('.tooth-lab');
    const allSelected = Array.from(allTeeth).every(tooth => tooth.classList.contains('selected'));
    
    allTeeth.forEach(tooth => {
        const toothNumber = tooth.dataset.toothNumber;
        if (allSelected) {
            tooth.classList.remove('selected');
            selectedTeeth.delete(toothNumber);
        } else {
            tooth.classList.add('selected');
            selectedTeeth.add(toothNumber);
        }
    });
    
    updateSelectedTeeth(allSelected ? null : 'all');
}

// انتخاب فک بالا
function selectUpperJaw() {
    const upperTeeth = document.querySelectorAll('.tooth-lab[data-tooth-number^="1"], .tooth-lab[data-tooth-number^="2"]');
    const allUpperSelected = Array.from(upperTeeth).every(tooth => tooth.classList.contains('selected'));
    
    upperTeeth.forEach(tooth => {
        const toothNumber = tooth.dataset.toothNumber;
        if (allUpperSelected) {
            tooth.classList.remove('selected');
            selectedTeeth.delete(toothNumber);
        } else {
            tooth.classList.add('selected');
            selectedTeeth.add(toothNumber);
        }
    });
    
    updateSelectedTeeth(allUpperSelected ? null : 'upper');
}

// انتخاب فک پایین
function selectLowerJaw() {
    const lowerTeeth = document.querySelectorAll('.tooth-lab[data-tooth-number^="3"], .tooth-lab[data-tooth-number^="4"]');
    const allLowerSelected = Array.from(lowerTeeth).every(tooth => tooth.classList.contains('selected'));
    
    lowerTeeth.forEach(tooth => {
        const toothNumber = tooth.dataset.toothNumber;
        if (allLowerSelected) {
            tooth.classList.remove('selected');
            selectedTeeth.delete(toothNumber);
        } else {
            tooth.classList.add('selected');
            selectedTeeth.add(toothNumber);
        }
    });
    
    updateSelectedTeeth(allLowerSelected ? null : 'lower');
}

// بروزرسانی اطلاعات دندان‌های انتخاب شده
function updateSelectedTeeth(jawType = null) {
    const selectedTeethArray = Array.from(selectedTeeth);
    document.getElementById('selected-teeth').value = selectedTeethArray.join(' - ');
    
    let scientificName = '';
    if (jawType && selectedTeethArray.length > 0) {
        scientificName = jawNames[jawType];
    } else {
        scientificName = selectedTeethArray
            .map(number => {
                const tooth = document.querySelector(`.tooth-lab[data-tooth-number="${number}"]`);
                return tooth ? tooth.dataset.toothName : '';
            })
            .filter(name => name) // حذف مقادیر خالی
            .join(' - ');
    }
    
    document.getElementById('teeth-names').value = scientificName;
    document.getElementById('teeth-count').value = selectedTeethArray.length > 0 ? 
        `${selectedTeethArray.length} دندان` : 
        '0 دندان';
}

// پاک کردن انتخاب‌ها
function clearSelection() {
    const allTeeth = document.querySelectorAll('.tooth-lab');
    allTeeth.forEach(tooth => {
        tooth.classList.remove('selected');
    });
    selectedTeeth.clear();
    updateSelectedTeeth();
}

// توابع مربوط به فاکتور
function showPaymentModal() {
    // نمایش مودال پرداخت
}

function printInvoice() {
    const printContent = document.getElementById('printable-invoice').innerHTML;
    const printWindow = window.open('', '', 'height=600,width=800');
    printWindow.document.write('<html><head><title>فاکتور</title>');
    printWindow.document.write('<style>/* استایل‌های پرینت */</style></head><body>');
    printWindow.document.write(printContent);
    printWindow.document.write('</body></html>');
    printWindow.document.close();
    printWindow.print();
}

function generateOfficialInvoice() {
    document.getElementById('invoice-modal').style.display = 'block';
    document.getElementById('invoice-number').value = generateInvoiceNumber();
    document.getElementById('invoice-date').value = getCurrentDate();
}

function generateInvoiceNumber() {
    return 'INV-' + Date.now();
}

function getCurrentDate() {
    return new Date().toLocaleDateString('fa-IR');
}

// راه‌اندازی اولیه
document.addEventListener('DOMContentLoaded', initializeToothSelection);

</script>
</body>
</html>
